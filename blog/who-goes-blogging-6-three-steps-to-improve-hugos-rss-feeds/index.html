<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script defer data-domain=jdheyburn.co.uk data-api=/other/apples/event src=https://jdheyburn.co.uk/other/apples/script.js></script><meta name=author content="Joseph D. Heyburn"><meta name=description content="Ramblings of a tech guy"><meta name=keywords content="blog,developer,devops,cloud"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/card.png"><meta name=twitter:title content="Who Goes Blogging 6: Three Steps to Improve Hugo's RSS Feeds"><meta name=twitter:description content="Spending time to ensure that posts are rendered nicely for RSS feeds"><meta property="og:title" content="Who Goes Blogging 6: Three Steps to Improve Hugo's RSS Feeds"><meta property="og:description" content="Spending time to ensure that posts are rendered nicely for RSS feeds"><meta property="og:type" content="article"><meta property="og:url" content="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/"><meta property="og:image" content="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/card.png"><meta property="article:published_time" content="2020-05-14T00:00:00+00:00"><meta property="article:modified_time" content="2020-12-14T00:00:00+00:00"><base href=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/><title>Who Goes Blogging 6: Three Steps to Improve Hugo's RSS Feeds · JDHeyburn
</title><link rel=canonical href=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://jdheyburn.co.uk/css/coder.min.f01c647a0d25b40da992a37c3376291185eed8a50ced8c26cc2c0bcfe38c97df.css integrity="sha256-8Bxkeg0ltA2pkqN8M3YpEYXu2KUM7YwmzCwLz+OMl98=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://jdheyburn.co.uk/css/coder-dark.min.126ad3988d46bdae6217a11105b53c9662bca05f39d42d3c0fb366919d334620.css integrity="sha256-EmrTmI1Gva5iF6ERBbU8lmK8oF851C08D7NmkZ0zRiA=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://jdheyburn.co.uk/css/custom.css><link rel=icon type=image/png href=https://jdheyburn.co.uk/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://jdheyburn.co.uk/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.124.1"></head><body class=colorscheme-dark><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://jdheyburn.co.uk/>JDHeyburn
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://jdheyburn.co.uk/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://jdheyburn.co.uk/blog/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://jdheyburn.co.uk/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=https://jdheyburn.co.uk/contact/>Contact</a></li></ul></section></nav><div class=content><section class="container post"><article><div><img class=featimage src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/cover.png alt="Featured image"></div><header><div class=post-title><h1 class=title>Who Goes Blogging 6: Three Steps to Improve Hugo's RSS Feeds</h1></div><div class=post-description><p>Spending time to ensure that posts are rendered nicely for RSS feeds</p></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i>
<time datetime=2020-05-14T00:00:00Z>14 May 2020
</time></span><span class=posted-on><i class="fas fa-calendar-plus"></i>
<time datetime=2020-12-14T00:00:00Z>14 December 2020
</time></span><span class=reading-time><i class="fas fa-clock"></i>
11-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<a href=https://jdheyburn.co.uk/tags/rss/>rss</a>
<span class=separator>•</span>
<a href=https://jdheyburn.co.uk/tags/cards/>cards</a></div></div></header><div><aside><nav id=TableOfContents><ul><li><a href=#what-is-rss>What is RSS?</a></li><li><a href=#the-problem>The Problem</a></li><li><a href=#rendering-full-site-content>Rendering Full Site Content</a></li><li><a href=#rendering-images-in-rss-posts>Rendering images in RSS posts</a><ul><li><a href=#why-it-is-breaking-triumph>Why it is breaking &#x1f624;</a></li><li><a href=#fix-image-rendering>Fix image rendering</a></li></ul></li><li><a href=#adding-cards-for-posts>Adding cards for posts</a><ul><li><a href=#adding-enclosure-tags>Adding enclosure tags</a></li></ul></li><li><a href=#summarising-changes-to-rss-xml>Summarising changes to RSS XML</a></li></ul></nav></aside><p>I &ldquo;fixed&rdquo; the default RSS template used by Hugo to show the full article content, along with images, and also talk about how to have social media cards appear in the RSS items too.</p><p>I uploaded my completed RSS file to <a href=https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920>GitHub Gist</a> &#x1f680;</p><h2 id=what-is-rss>What is RSS?</h2><p><a href=https://en.wikipedia.org/wiki/RSS>RSS</a> is a great way to &ldquo;subscribe&rdquo; to websites to ensure that you don&rsquo;t miss content from them. The standard for how it is generated has been the same for decades now - however its still the best supported and most accepted way to receive updates. It is simply a standardised XML file that allows consumers such as RSS aggregators to parse the content of the post - for which there are many to choose from (RIP <a href=https://en.wikipedia.org/wiki/Google_Reader>Google Reader</a>).</p><figure class=center><a href=inoreader-complete.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/inoreader-complete.png alt="inoreader as an RSS feed aggregator"></a><figcaption><p>My RSS aggregator of choice currently is <a href=https://www.inoreader.com/>inoreader</a> - I&rsquo;ll be using this in my examples</p></figcaption></figure><p>Hugo <a href=https://gohugo.io/templates/rss/>generates RSS XML</a> files from a template that will loop over your content and expose this at an endpoint for RSS aggregators to subscribe to and periodically check for updates against. Hugo generates a bunch of RSS XML files at different sections of the website, allowing consumers to subscribe to the section that interests them most - you can even subscribe to tags if that XML is being generated!</p><p>Usually there is site top-level available at <code>/index.xml</code> - in the case of my site that would be <a href=https://jdheyburn.co.uk/index.xml>https://jdheyburn.co.uk/index.xml</a>. The source code for the template file Hugo uses to generate this is embedded in Hugo at <a href=https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml>this location</a>.</p><h2 id=the-problem>The Problem</h2><p>Some (but not all) websites only include the first paragraph of their post in an RSS update (aka summary), along with a message after that paragraph requesting the reader to visit the site in a browser to view the rest of the content.</p><p>This is a common feature of WordPress blogs - and it is done to have you load the full website and along with it, all the code for providing the owner with user analytics, and advertising - if they have it. So really they&rsquo;re getting the benefit of being able to publish updates via a standardised approach (RSS), to then lure you onto the website.</p><figure class=center><a href=rss-post-show-more-content.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/rss-post-show-more-content.png alt="An RSS post loading incompletely"></a></figure><p>Hugo <em>kind of</em> does this through the highlighted line in the <a href=https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml>templated RSS XML file</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#ff79c6>&lt;description&gt;</span>{{ .Summary | html }}<span style=color:#ff79c6>&lt;/description&gt;</span>
</span></span></code></pre></div><p><code>.Summary</code> will do what was just described, print out the first paragraph of your post. However unlike WordPress, it doesn&rsquo;t actually say if there is more content. So users may not load your full website, instead thinking you&rsquo;ve produced a very short article!</p><figure class=center><a href=hugo-incomplete-post.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-incomplete-post.png alt="Hugo producing a summarised RSS post"></a></figure><p>I&rsquo;m not against the practice of previewing the post, if a blog provides revenue for the author(s) then you will need to force readers to view the full website for analytics and advertising (businesses gotta make money!).</p><p>Although I&rsquo;m sure the initial purpose of RSS was only meant to be used to provide subscribers a pure text version of your content. At the end of the day, I believe the author should give the reader choice on mediums of consumption - and they accept the limitations that come from RSS.</p><p>So now, I&rsquo;ll be making several changes to the Hugo template RSS XML file to produce the full site content, along with some other enhancements.</p><h2 id=rendering-full-site-content>Rendering Full Site Content</h2><p>Before we start editing files, we need to produce our own copy of the template RSS XML file. This is embedded directly within Hugo itself and not packaged in with your theme.</p><blockquote><p>There&rsquo;s every chance your theme is generating one for you. Run the below command to see if there is anything for you to copy from.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find themes/ -type f -name <span style=color:#f1fa8c>&#39;*.xml&#39;</span>
</span></span></code></pre></div></blockquote><p>We&rsquo;ve discussed template lookup orders before in <a href=https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#template-lookup-order-primer>previous posts</a> - we can overwrite the default of any file used in generating the website by placing it in your local project root.</p><p>We can start to make modifications to the <code>rss.xml</code> file by copying the <a href=https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml>default</a> into the directory where Hugo will read it from.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#6272a4># Assuming you are in project root</span>
</span></span><span style=display:flex><span>wget https://raw.githubusercontent.com/gohugoio/hugo/master/tpl/tplimpl/embedded/templates/_default/rss.xml -O layouts/_default/rss.xml
</span></span></code></pre></div><p>We know that line 35 containing <code>.Summary</code> is causing the issue here. All we need to do is change it to <code>.Content</code> - then Hugo will print out the entire content of your post. See the highlighted line below for the change.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style=background-color:#3d3f4a><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#ff79c6>&lt;item&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>&lt;title&gt;</span>{{ .Title }}<span style=color:#ff79c6>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>&lt;link&gt;</span>{{ .Permalink }}<span style=color:#ff79c6>&lt;/link&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>&lt;pubDate&gt;</span>{{ .Date.Format &#34;Mon, 02 Jan 2006 15:04:05 -0700&#34; | safeHTML }}<span style=color:#ff79c6>&lt;/pubDate&gt;</span>
</span></span><span style=display:flex><span>      {{ with .Site.Author.email }}<span style=color:#ff79c6>&lt;author&gt;</span>{{.}}{{ with $.Site.Author.name }} ({{.}}){{end}}<span style=color:#ff79c6>&lt;/author&gt;</span>{{end}}
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>&lt;guid&gt;</span>{{ .Permalink }}<span style=color:#ff79c6>&lt;/guid&gt;</span>
</span></span><span style=display:flex;background-color:#3d3f4a><span>      <span style=color:#ff79c6>&lt;description&gt;</span>{{ .Content | html }}<span style=color:#ff79c6>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;/item&gt;</span>
</span></span><span style=display:flex><span>    {{ end }}
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;/channel&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;/rss&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s now view the changes in the RSS reader.</p><figure class=center><a href=hugo-complete-post.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-complete-post.png alt="Hugo RSS post displaying all content"></a><figcaption><p>We can now see much more content is being produced - and with proper HTML this time!</p></figcaption></figure><blockquote><p><strong>UPDATE 2020-12-14</strong></p><p>I came across an issue whereby code indentation wasn&rsquo;t rendering properly in RSS feeds if you used the <code>--minify</code> parameter - <a href=https://jdheyburn.co.uk/blog/who-goes-blogging-7-hugo-minify-rss-code-indentation-fix/>this post</a> resolves it.</p></blockquote><h2 id=rendering-images-in-rss-posts>Rendering images in RSS posts</h2><p>Depending on how you are retrieving images - you may find that they are not displaying, and that the image alterative (<code>alt</code>) text is being displayed instead.</p><figure class=center><a href=hugo-missing-images-post.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-missing-images-post.png alt="Hugo RSS post with missing images, alt text displayed instead"></a><figcaption><p>Note the highlighted alt texts of images</p></figcaption></figure><blockquote><p>If you&rsquo;re not already providing an <code>alt</code> field to your <code>&lt;img></code> blocks then <strong>you absolutely need to</strong>.</p><p>They help boost accessibility to your website should the user have a text-to-voice application reading your website.</p><p>They also provide a helpful description to your image in case it cannot load - which happens more often than you think!</p></blockquote><h3 id=why-it-is-breaking-triumph>Why it is breaking &#x1f624;</h3><p>In <a href=https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/>part 4</a> of this series, we looked at placing resources for a post in the same directory as the content markdown file (also known as <a href=https://gohugo.io/content-management/page-bundles/#leaf-bundles>leaf bundles</a>).</p><p>That means for a given directory tree structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tree content/blog
</span></span><span style=display:flex><span>content/blog
</span></span><span style=display:flex><span>└── some-blog-post
</span></span><span style=display:flex><span>    ├── image-file-name.png
</span></span><span style=display:flex><span>    └── index.md
</span></span></code></pre></div><p>We would use the following shortcode to generate the <code>&lt;img></code> block in <code>index.md</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>{{&lt; figure src=<span style=color:#f1fa8c>&#34;image-file-name.png&#34;</span> alt=<span style=color:#f1fa8c>&#34;Here is an image!&#34;</span> &gt;}}
</span></span></code></pre></div><p>This produces the block:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#ff79c6>figure</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#ff79c6>img</span> <span style=color:#50fa7b>src</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image-file-name.png&#34;</span> <span style=color:#50fa7b>alt</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;Here is an image!&#34;</span>&gt;  
</span></span><span style=display:flex><span>&lt;/<span style=color:#ff79c6>figure</span>&gt;
</span></span></code></pre></div><p>Since this contains no preceding forward-slash <code>/</code> in <code>src</code>, this becomes a <em>relative path</em>. This means the webserver will look for the image at the path relative to the current page.</p><p>So when we navigate to <code>blog/some-blog-post/</code> in our web browser (as dictated from the above tree structure), your browser will request the image at <code>blog/some-blog-post/image-file-name.png</code> for you.</p><p>Why is this relevant? This same <code>&lt;img></code> block is being rendered in the description of your RSS XML file, including the relative image location. RSS is very simple and renders only complete URLs (e.g. <code>https://jdheyburn.co.uk/blog/some-blog-post/image-file-name.png</code>) - so when we just specify the relative path, it cannot find the image and thus prints out the <code>alt</code> text.</p><blockquote><p><strong>Note:</strong> if you specify images from a complete path such as <code>/images/image-file-name.png</code> under <code>static/images</code>, then this is not an issue for you.</p></blockquote><h3 id=fix-image-rendering>Fix image rendering</h3><p>The fix for this involves some Go magic. We need to prepend the permalink for the current post that&rsquo;s being printed out to anything that contains a relative path <code>&lt;img></code> block.</p><p>We need to go back to the same line where we added <code>.Content</code> and change it to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#ff79c6>&lt;description&gt;</span>{{ replaceRE &#34;img src=\&#34;(.*?)\&#34;&#34; (printf &#34;%s%s%s&#34; &#34;img src=\&#34;&#34; .Permalink &#34;$1\&#34;&#34;) .Content | html }}<span style=color:#ff79c6>&lt;/description&gt;</span>
</span></span></code></pre></div><p>This calls the Hugo function <a href=https://gohugo.io/functions/replacere/>replaceRE</a> which enables us to perform a find-and-replace using <a href=https://www.regular-expressions.info/tutorial.html>regular expressions (regex)</a>, and it takes three inputs:</p><ul><li><code>PATTERN</code> is the regex pattern used to find the text we want to remove<ul><li><code>"img src=\"(.*?)\""</code></li></ul></li><li><code>REPLACEMENT</code> is the text that we want to replace the <code>PATTERN</code> with<ul><li><code>(printf "%s%s%s" "img src=\"" .Permalink "$1\"")</code></li></ul></li><li><code>INPUT</code> is the string we want to perform the find-and-replace on<ul><li><code>.Content</code></li></ul></li></ul><p>In the example above, we&rsquo;re placing a <a href=https://www.regular-expressions.info/brackets.html>capturing group</a> in the <code>PATTERN</code> so that it will capture the contents inside <code>src</code> and save them so that we can refer to it in the <code>REPLACEMENT</code>, while removing <code>img src=""</code>.</p><p><code>REPLACEMENT</code> is calling another Hugo function called <a href=https://gohugo.io/functions/printf/>printf</a> to construct the replacement text. We&rsquo;re pretty much just injecting the page <code>.Permalink</code> prior to the captured text from the <code>PATTERN</code> - so that RSS can then display the complete URL. While adding back the <code>img src=""</code> that was removed.</p><p><code>INPUT</code> will be the page <code>.Content</code>, what we were printing out before.</p><p>Once we&rsquo;ve made the change, images are now rendered properly!</p><figure class=center><a href=hugo-images-post.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-images-post.png alt="Hugo RSS post with images being correctly rendered"></a></figure><blockquote><p><strong>UPDATE 2020-05-16</strong></p><p>Upon posting this, I noticed I needed to do the same thing for hyperlinks referencing headings with the same post. For instance the markdown below which renders a hyperlink to a heading&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>[<span style=color:#ff79c6>images to display in RSS content</span>](<span style=color:#50fa7b>#rendering-images-in-rss-posts</span>)
</span></span></code></pre></div><p>Will render this in RSS:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#ff79c6>a</span> <span style=color:#50fa7b>href</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;https://jdheyburn.co.uk/#rendering-images-in-rss-posts&#34;</span>&gt;
</span></span></code></pre></div><p>Which does not take the reader to the right location at all. What we need to do is repeat the regex used above in <code>rss.xml</code> to catch these and replace them with the complete URL. See below for the snippet.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span>{{<span style=color:#ff79c6>-</span> $content <span style=color:#ff79c6>:=</span> replaceRE <span style=color:#f1fa8c>&#34;a href=\&#34;(#.*?)\&#34;&#34;</span> (printf <span style=color:#f1fa8c>&#34;%s%s%s&#34;</span> <span style=color:#f1fa8c>&#34;a href=\&#34;&#34;</span> .Permalink <span style=color:#f1fa8c>&#34;$1\&#34;&#34;</span>) .Content <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#ff79c6>-</span> $content = replaceRE <span style=color:#f1fa8c>&#34;img src=\&#34;(.*?)\&#34;&#34;</span> (printf <span style=color:#f1fa8c>&#34;%s%s%s&#34;</span> <span style=color:#f1fa8c>&#34;img src=\&#34;&#34;</span> .Permalink <span style=color:#f1fa8c>&#34;$1\&#34;&#34;</span>) $content <span style=color:#ff79c6>-</span>}}
</span></span><span style=display:flex><span>&lt;description&gt;{{ $content | html }}&lt;<span style=color:#ff79c6>/</span>description&gt;
</span></span></code></pre></div></blockquote><h2 id=adding-cards-for-posts>Adding cards for posts</h2><p>Not dissimilar to <a href=https://barkersocial.com/social-cards/>social media cards</a>, you can also have cards appear for your RSS posts in order to make them more attractive for readers to click on!</p><figure class=center><a href=inoreader-enclosure-card-view.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/inoreader-enclosure-card-view.png alt="inoreader displaying images for each post when in card view"></a><figcaption><p>While in card view for inoreader, we can see featured images being displayed</p></figcaption></figure><p>You can do these in RSS via the <a href=https://www.w3schools.com/xml/rss_tag_enclosure.asp>enclosure</a> tag&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#ff79c6>enclosure</span> <span style=color:#50fa7b>url</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image-location.png&#34;</span> <span style=color:#50fa7b>type</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image/jpg&#34;</span>&gt;&lt;/<span style=color:#ff79c6>enclosure</span>&gt;
</span></span></code></pre></div><p>If you have a look at our <code>layouts/_default/rss.xml</code> file, we don&rsquo;t have this defined. We could go and add it in now, but I would like a unified social media image to be used across all platforms. This will enable me to focus my effort on generating a single social media card image that is shared across all methods of consumption.</p><p>Based on the above, my theme (hugo-coder), renders the tags required for social media cards through the <a href=https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/twitter_cards.html>internal template</a> for <a href=https://gohugo.io/templates/internal/#use-the-twitter-cards-template>twitter_cards</a>. A snippet of the logic that determines this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{{- with $.Params.images -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:card&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;summary_large_image&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:image&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ index . 0 | absURL }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>{{ else -}}
</span></span><span style=display:flex><span>{{- $images := $.Resources.ByType &#34;image&#34; -}}
</span></span><span style=display:flex><span>{{- $featured := $images.GetMatch &#34;*feature*&#34; -}}
</span></span><span style=display:flex><span>{{- if not $featured }}{{ $featured = $images.GetMatch &#34;{*cover*,*thumbnail*}&#34; }}{{ end -}}
</span></span><span style=display:flex><span>{{- with $featured -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:card&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;summary_large_image&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:image&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ $featured.Permalink }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>{{- else -}}
</span></span><span style=display:flex><span>{{- with $.Site.Params.images -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:card&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;summary_large_image&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>name</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;twitter:image&#34;</span> <span style=color:#50fa7b>content</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ index . 0 | absURL }}&#34;</span>/&gt;
</span></span><span style=display:flex><span>{{ else -}}
</span></span><span style=display:flex><span>...
</span></span></code></pre></td></tr></table></div></div><p>The hierarchy of images used to render the social media card goes like this:</p><ol><li>The first entry in the list of <code>images</code> found in the post front matter</li><li>Any image in the post leaf bundle containing <code>feature</code> in its name</li><li>Any image in the post leaf bundle containing either <code>cover</code> or <code>thumbnail</code> in its name</li><li>The default image defined at the site level params</li></ol><h3 id=adding-enclosure-tags>Adding enclosure tags</h3><p>We can effectively copy and paste the code being used for generating Twitter cards and modify it for enclosure tags. The snippet of code ultimately ends up looking like this &#x1f447;</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{{- $pagePermalink := .Permalink -}}
</span></span><span style=display:flex><span>{{- with .Params.images -}}
</span></span><span style=display:flex><span>{{- $img := index . 0 -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>enclosure</span> <span style=color:#50fa7b>url</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ printf &#34;</span>%<span style=color:#50fa7b>s</span>%<span style=color:#50fa7b>s</span>&#34; $<span style=color:#50fa7b>pagePermalink</span> $<span style=color:#50fa7b>img</span> }}&#34; <span style=color:#50fa7b>type</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image/jpg&#34;</span>&gt;&lt;/<span style=color:#ff79c6>enclosure</span>&gt;
</span></span><span style=display:flex><span>{{ else -}}
</span></span><span style=display:flex><span>{{- $images := .Resources.ByType &#34;image&#34; -}}
</span></span><span style=display:flex><span>{{- $featured := $images.GetMatch &#34;*feature*&#34; -}}
</span></span><span style=display:flex><span>{{- if not $featured }}{{ $featured = $images.GetMatch &#34;{*cover*,*thumbnail*}&#34; }}{{ end -}}
</span></span><span style=display:flex><span>{{- with $featured -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>enclosure</span> <span style=color:#50fa7b>url</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ $featured.Permalink }}&#34;</span> <span style=color:#50fa7b>type</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image/jpg&#34;</span>&gt;&lt;/<span style=color:#ff79c6>enclosure</span>&gt;
</span></span><span style=display:flex><span>{{- else -}}
</span></span><span style=display:flex><span>{{- with .Site.Params.images -}}
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>enclosure</span> <span style=color:#50fa7b>url</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;{{ index . 0 | absURL }}&#34;</span> <span style=color:#50fa7b>type</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;image/jpg&#34;</span>&gt;&lt;/<span style=color:#ff79c6>enclosure</span>&gt;
</span></span><span style=display:flex><span>{{- end -}}
</span></span><span style=display:flex><span>{{- end -}}
</span></span><span style=display:flex><span>{{- end }}
</span></span></code></pre></td></tr></table></div></div><p>Walking through what this is doing:</p><ul><li>Lines 1-4 will use the image defined in the <code>images</code> in the post front matter, if it exists<ul><li>I had to define <code>{{-/* $pagePermalink := .Permalink */-}}</code> on line 1 to make <code>.Permalink</code> available inside the <code>with</code> block at line 4</li></ul></li><li>Line 7 will find an image containing <code>feature</code> in its name, at the post leaf bundle section, if an image is not found previously</li><li>Line 8 will revert to an image containing either <code>cover</code> or <code>thumbnail</code>, if an image is not found previously</li><li>Lines 12-13 will default to the image defined at the site level params</li></ul><p>With lessons learnt trying to get <a href=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/#rendering-images-in-rss-posts>images to display in RSS content</a>, I am rendering the full URL of the image to ensure RSS is always able to retrieve it.</p><p>I&rsquo;m going to follow lines 12-13 above and have a default card defined at the site level parameters. In my <code>config.toml</code> I&rsquo;ll need to add the following&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[params]
</span></span><span style=display:flex><span>    images = [<span style=color:#f1fa8c>&#34;images/jdheyburn_co_uk_card.png&#34;</span>]
</span></span></code></pre></div><p>&mldr;while also ensuring that I&rsquo;ve placed the image under <code>static/images/jdheyburn_co_uk_card.png</code>.</p><p>Once all that is done and deployed - we will have an RSS post card that looks like this &#x1f64c;</p><figure class=center><a href=hugo-enclosure-card-view.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-enclosure-card-view.png alt="inoreader displaying an image for a Hugo post"></a></figure><p>We can now advertise our RSS subscription URL to readers. My theme <code>hugo-coder</code> supports this as a social button on the home page. We just need to add the below block to the <code>config.toml</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[[params.social]]
</span></span><span style=display:flex><span>    name = <span style=color:#f1fa8c>&#34;RSS&#34;</span>
</span></span><span style=display:flex><span>    icon = <span style=color:#f1fa8c>&#34;fas fa-rss&#34;</span>
</span></span><span style=display:flex><span>    weight = <span style=color:#bd93f9>6</span>
</span></span><span style=display:flex><span>    url = <span style=color:#f1fa8c>&#34;https://jdheyburn.co.uk/index.xml&#34;</span>
</span></span><span style=display:flex><span>    rel = <span style=color:#f1fa8c>&#34;alternate&#34;</span>
</span></span><span style=display:flex><span>    type = <span style=color:#f1fa8c>&#34;application/rss+xml&#34;</span>
</span></span></code></pre></div><p>Once done - our homepage will have the button displayed.</p><figure class=center><a href=rss-subscription-button.png><img src=https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/rss-subscription-button.png alt="RSS subscription button displayed on the homepage"></a></figure><h2 id=summarising-changes-to-rss-xml>Summarising changes to RSS XML</h2><p>You can view the gist below to see my complete RSS XML file after all the above has been added. If you wish to use it, you&rsquo;ll need to place it in <code>layouts/_default/rss.xml</code> in your project directory.</p><script src=https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920.js></script><p><a href=https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920/revisions>Click here</a> for a <code>git diff</code> view on the changes I made from the default RSS XML file.</p><p>Thanks for reading! &#x1f4af;</p></div><footer><section class=see-also></section></footer></article></section></div><footer class=footer><section class=container>©
2025
Joseph D. Heyburn
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main></body></html>