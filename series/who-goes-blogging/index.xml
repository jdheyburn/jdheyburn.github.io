<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Who Goes Blogging on JDHeyburn</title><link>https://jdheyburn.co.uk/series/who-goes-blogging/</link><description>Recent content in Who Goes Blogging on JDHeyburn</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 14 May 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://jdheyburn.co.uk/series/who-goes-blogging/index.xml" rel="self" type="application/rss+xml"/><item><title>Who Goes Blogging 6: Three Steps to Improve Hugo's RSS Feeds</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/cover.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/</link><pubDate>Thu, 14 May 2020 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/</guid>--><description>&lt;p>I &amp;ldquo;fixed&amp;rdquo; the default RSS template used by Hugo to show the full article content, along with images, and also talk about how to have social media cards appear in the RSS items too.&lt;/p>
&lt;p>I uploaded my completed RSS file to &lt;a href="https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920">GitHub Gist&lt;/a> ðŸš€&lt;/p>
&lt;h2 id="what-is-rss">What is RSS?&lt;/h2>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/RSS">RSS&lt;/a> is a great way to &amp;ldquo;subscribe&amp;rdquo; to websites to ensure that you don&amp;rsquo;t miss content from them. The standard for how it is generated has been the same for decades now - however its still the best supported and most accepted way to receive updates. It is simply a standardised XML file that allows consumers such as RSS aggregators to parse the content of the post - for which there are many to choose from (RIP &lt;a href="https://en.wikipedia.org/wiki/Google_Reader">Google Reader&lt;/a>).&lt;/p>
&lt;figure class="center">&lt;a href="inoreader-complete.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/inoreader-complete.png"
alt="inoreader as an RSS feed aggregator"/> &lt;/a>&lt;figcaption>
&lt;p>My RSS aggregator of choice currently is &lt;a href="https://www.inoreader.com/">inoreader&lt;/a> - I&amp;rsquo;ll be using this in my examples&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Hugo &lt;a href="https://gohugo.io/templates/rss/">generates RSS XML&lt;/a> files from a template that will loop over your content and expose this at an endpoint for RSS aggregators to subscribe to and periodically check for updates against. Hugo generates a bunch of RSS XML files at different sections of the website, allowing consumers to subscribe to the section that interests them most - you can even subscribe to tags if that XML is being generated!&lt;/p>
&lt;p>Usually there is site top-level available at &lt;code>/index.xml&lt;/code> - in the case of my site that would be &lt;a href="https://jdheyburn.co.uk/index.xml">https://jdheyburn.co.uk/index.xml&lt;/a>. The source code for the template file Hugo uses to generate this is embedded in Hugo at &lt;a href="https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml">this location&lt;/a>.&lt;/p>
&lt;h2 id="the-problem">The Problem&lt;/h2>
&lt;p>Some (but not all) websites only include the first paragraph of their post in an RSS update (aka summary), along with a message after that paragraph requesting the reader to visit the site in a browser to view the rest of the content.&lt;/p>
&lt;p>This is a common feature of WordPress blogs - and it is done to have you load the full website and along with it, all the code for providing the owner with user analytics, and advertising - if they have it. So really they&amp;rsquo;re getting the benefit of being able to publish updates via a standardised approach (RSS), to then lure you onto the website.&lt;/p>
&lt;figure class="center">&lt;a href="rss-post-show-more-content.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/rss-post-show-more-content.png"
alt="An RSS post loading incompletely"/> &lt;/a>
&lt;/figure>
&lt;p>Hugo &lt;em>kind of&lt;/em> does this through the highlighted line in the &lt;a href="https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml">templated RSS XML file&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-xml" data-lang="xml">&lt;span style="color:#ff79c6">&amp;lt;description&amp;gt;&lt;/span>{{ .Summary | html }}&lt;span style="color:#ff79c6">&amp;lt;/description&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>.Summary&lt;/code> will do what was just described, print out the first paragraph of your post. However unlike WordPress, it doesn&amp;rsquo;t actually say if there is more content. So users may not load your full website, instead thinking you&amp;rsquo;ve produced a very short article!&lt;/p>
&lt;figure class="center">&lt;a href="hugo-incomplete-post.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-incomplete-post.png"
alt="Hugo producing a summarised RSS post"/> &lt;/a>
&lt;/figure>
&lt;p>I&amp;rsquo;m not against the practice of previewing the post, if a blog provides revenue for the author(s) then you will need to force readers to view the full website for analytics and advertising (businesses gotta make money!).&lt;/p>
&lt;p>Although I&amp;rsquo;m sure the initial purpose of RSS was only meant to be used to provide subscribers a pure text version of your content. At the end of the day, I believe the author should give the reader choice on mediums of consumption - and they accept the limitations that come from RSS.&lt;/p>
&lt;p>So now, I&amp;rsquo;ll be making several changes to the Hugo template RSS XML file to produce the full site content, along with some other enhancements.&lt;/p>
&lt;h2 id="rendering-full-site-content">Rendering Full Site Content&lt;/h2>
&lt;p>Before we start editing files, we need to produce our own copy of the template RSS XML file. This is embedded directly within Hugo itself and not packaged in with your theme.&lt;/p>
&lt;blockquote>
&lt;p>There&amp;rsquo;s every chance your theme is generating one for you. Run the below command to see if there is anything for you to copy from.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">find themes/ -type f -name &lt;span style="color:#f1fa8c">&amp;#39;*.xml&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;p>We&amp;rsquo;ve discussed template lookup orders before in &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#template-lookup-order-primer">previous posts&lt;/a> - we can overwrite the default of any file used in generating the website by placing it in your local project root.&lt;/p>
&lt;p>We can start to make modifications to the &lt;code>rss.xml&lt;/code> file by copying the &lt;a href="https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml">default&lt;/a> into the directory where Hugo will read it from.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#6272a4"># Assuming you are in project root&lt;/span>
wget https://raw.githubusercontent.com/gohugoio/hugo/master/tpl/tplimpl/embedded/templates/_default/rss.xml -O layouts/_default/rss.xml
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We know that line 35 containing &lt;code>.Summary&lt;/code> is causing the issue here. All we need to do is change it to &lt;code>.Content&lt;/code> - then Hugo will print out the entire content of your post. See the highlighted line below for the change.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-xml" data-lang="xml"> &lt;span style="color:#ff79c6">&amp;lt;item&amp;gt;&lt;/span>
&lt;span style="color:#ff79c6">&amp;lt;title&amp;gt;&lt;/span>{{ .Title }}&lt;span style="color:#ff79c6">&amp;lt;/title&amp;gt;&lt;/span>
&lt;span style="color:#ff79c6">&amp;lt;link&amp;gt;&lt;/span>{{ .Permalink }}&lt;span style="color:#ff79c6">&amp;lt;/link&amp;gt;&lt;/span>
&lt;span style="color:#ff79c6">&amp;lt;pubDate&amp;gt;&lt;/span>{{ .Date.Format &amp;#34;Mon, 02 Jan 2006 15:04:05 -0700&amp;#34; | safeHTML }}&lt;span style="color:#ff79c6">&amp;lt;/pubDate&amp;gt;&lt;/span>
{{ with .Site.Author.email }}&lt;span style="color:#ff79c6">&amp;lt;author&amp;gt;&lt;/span>{{.}}{{ with $.Site.Author.name }} ({{.}}){{end}}&lt;span style="color:#ff79c6">&amp;lt;/author&amp;gt;&lt;/span>{{end}}
&lt;span style="color:#ff79c6">&amp;lt;guid&amp;gt;&lt;/span>{{ .Permalink }}&lt;span style="color:#ff79c6">&amp;lt;/guid&amp;gt;&lt;/span>
&lt;span style="display:block;width:100%;background-color:#3d3f4a"> &lt;span style="color:#ff79c6">&amp;lt;description&amp;gt;&lt;/span>{{ .Content | html }}&lt;span style="color:#ff79c6">&amp;lt;/description&amp;gt;&lt;/span>
&lt;/span> &lt;span style="color:#ff79c6">&amp;lt;/item&amp;gt;&lt;/span>
{{ end }}
&lt;span style="color:#ff79c6">&amp;lt;/channel&amp;gt;&lt;/span>
&lt;span style="color:#ff79c6">&amp;lt;/rss&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Let&amp;rsquo;s now view the changes in the RSS reader.&lt;/p>
&lt;figure class="center">&lt;a href="hugo-complete-post.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-complete-post.png"
alt="Hugo RSS post displaying all content"/> &lt;/a>&lt;figcaption>
&lt;p>We can now see much more content is being produced - and with proper HTML this time!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="rendering-images-in-rss-posts">Rendering images in RSS posts&lt;/h2>
&lt;p>Depending on how you are retrieving images - you may find that they are not displaying, and that the image alterative (&lt;code>alt&lt;/code>) text is being displayed instead.&lt;/p>
&lt;figure class="center">&lt;a href="hugo-missing-images-post.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-missing-images-post.png"
alt="Hugo RSS post with missing images, alt text displayed instead"/> &lt;/a>&lt;figcaption>
&lt;p>Note the highlighted alt texts of images&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;blockquote>
&lt;p>If you&amp;rsquo;re not already providing an &lt;code>alt&lt;/code> field to your &lt;code>&amp;lt;img&amp;gt;&lt;/code> blocks then &lt;strong>you absolutely need to&lt;/strong>.&lt;/p>
&lt;p>They help boost accessibility to your website should the user have a text-to-voice application reading your website.&lt;/p>
&lt;p>They also provide a helpful description to your image in case it cannot load - which happens more often than you think!&lt;/p>
&lt;/blockquote>
&lt;h3 id="why-it-is-breaking-">Why it is breaking ðŸ˜¤&lt;/h3>
&lt;p>In &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/">part 4&lt;/a> of this series, we looked at placing resources for a post in the same directory as the content markdown file (also known as &lt;a href="https://gohugo.io/content-management/page-bundles/#leaf-bundles">leaf bundles&lt;/a>).&lt;/p>
&lt;p>That means for a given directory tree structure:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree content/blog
content/blog
â””â”€â”€ some-blog-post
â”œâ”€â”€ image-file-name.png
â””â”€â”€ index.md
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We would use the following shortcode to generate the &lt;code>&amp;lt;img&amp;gt;&lt;/code> block in &lt;code>index.md&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">{{&amp;lt; figure src=&lt;span style="color:#f1fa8c">&amp;#34;image-file-name.png&amp;#34;&lt;/span> alt=&lt;span style="color:#f1fa8c">&amp;#34;Here is an image!&amp;#34;&lt;/span> &amp;gt;}}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This produces the block:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#ff79c6">figure&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#ff79c6">img&lt;/span> &lt;span style="color:#50fa7b">src&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image-file-name.png&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">alt&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;Here is an image!&amp;#34;&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#ff79c6">figure&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Since this contains no preceding forward-slash &lt;code>/&lt;/code> in &lt;code>src&lt;/code>, this becomes a &lt;em>relative path&lt;/em>. This means the webserver will look for the image at the path relative to the current page.&lt;/p>
&lt;p>So when we navigate to &lt;code>blog/some-blog-post/&lt;/code> in our web browser (as dictated from the above tree structure), your browser will request the image at &lt;code>blog/some-blog-post/image-file-name.png&lt;/code> for you.&lt;/p>
&lt;p>Why is this relevant? This same &lt;code>&amp;lt;img&amp;gt;&lt;/code> block is being rendered in the description of your RSS XML file, including the relative image location. RSS is very simple and renders only complete URLs (e.g. &lt;code>https://jdheyburn.co.uk/blog/some-blog-post/image-file-name.png&lt;/code>) - so when we just specify the relative path, it cannot find the image and thus prints out the &lt;code>alt&lt;/code> text.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Note:&lt;/strong> if you specify images from a complete path such as &lt;code>/images/image-file-name.png&lt;/code> under &lt;code>static/images&lt;/code>, then this is not an issue for you.&lt;/p>
&lt;/blockquote>
&lt;h3 id="fix-image-rendering">Fix image rendering&lt;/h3>
&lt;p>The fix for this involves some Go magic. We need to prepend the permalink for the current post that&amp;rsquo;s being printed out to anything that contains a relative path &lt;code>&amp;lt;img&amp;gt;&lt;/code> block.&lt;/p>
&lt;p>We need to go back to the same line where we added &lt;code>.Content&lt;/code> and change it to:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-xml" data-lang="xml">&lt;span style="color:#ff79c6">&amp;lt;description&amp;gt;&lt;/span>{{ replaceRE &amp;#34;img src=\&amp;#34;(.*?)\&amp;#34;&amp;#34; (printf &amp;#34;%s%s%s&amp;#34; &amp;#34;img src=\&amp;#34;&amp;#34; .Permalink &amp;#34;$1\&amp;#34;&amp;#34;) .Content | html }}&lt;span style="color:#ff79c6">&amp;lt;/description&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This calls the Hugo function &lt;a href="https://gohugo.io/functions/replacere/">replaceRE&lt;/a> which enables us to perform a find-and-replace using &lt;a href="https://www.regular-expressions.info/tutorial.html">regular expressions (regex)&lt;/a>, and it takes three inputs:&lt;/p>
&lt;ul>
&lt;li>&lt;code>PATTERN&lt;/code> is the regex pattern used to find the text we want to remove
&lt;ul>
&lt;li>&lt;code>&amp;quot;img src=\&amp;quot;(.*?)\&amp;quot;&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>REPLACEMENT&lt;/code> is the text that we want to replace the &lt;code>PATTERN&lt;/code> with
&lt;ul>
&lt;li>&lt;code>(printf &amp;quot;%s%s%s&amp;quot; &amp;quot;img src=\&amp;quot;&amp;quot; .Permalink &amp;quot;$1\&amp;quot;&amp;quot;)&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>INPUT&lt;/code> is the string we want to perform the find-and-replace on
&lt;ul>
&lt;li>&lt;code>.Content&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>In the example above, we&amp;rsquo;re placing a &lt;a href="https://www.regular-expressions.info/brackets.html">capturing group&lt;/a> in the &lt;code>PATTERN&lt;/code> so that it will capture the contents inside &lt;code>src&lt;/code> and save them so that we can refer to it in the &lt;code>REPLACEMENT&lt;/code>, while removing &lt;code>img src=&amp;quot;&amp;quot;&lt;/code>.&lt;/p>
&lt;p>&lt;code>REPLACEMENT&lt;/code> is calling another Hugo function called &lt;a href="https://gohugo.io/functions/printf/">printf&lt;/a> to construct the replacement text. We&amp;rsquo;re pretty much just injecting the page &lt;code>.Permalink&lt;/code> prior to the captured text from the &lt;code>PATTERN&lt;/code> - so that RSS can then display the complete URL. While adding back the &lt;code>img src=&amp;quot;&amp;quot;&lt;/code> that was removed.&lt;/p>
&lt;p>&lt;code>INPUT&lt;/code> will be the page &lt;code>.Content&lt;/code>, what we were printing out before.&lt;/p>
&lt;p>Once we&amp;rsquo;ve made the change, images are now rendered properly!&lt;/p>
&lt;figure class="center">&lt;a href="hugo-images-post.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-images-post.png"
alt="Hugo RSS post with images being correctly rendered"/> &lt;/a>
&lt;/figure>
&lt;blockquote>
&lt;p>&lt;strong>UPDATE 2020-05-16&lt;/strong>&lt;/p>
&lt;p>Upon posting this, I noticed I needed to do the same thing for hyperlinks referencing headings with the same post. For instance the markdown below which renders a hyperlink to a heading&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-markdown" data-lang="markdown">[&lt;span style="color:#ff79c6">images to display in RSS content&lt;/span>](&lt;span style="color:#50fa7b">#rendering-images-in-rss-posts&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Will render this in RSS:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#ff79c6">a&lt;/span> &lt;span style="color:#50fa7b">href&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;https://jdheyburn.co.uk/#rendering-images-in-rss-posts&amp;#34;&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Which does not take the reader to the right location at all. What we need to do is repeat the regex used above in &lt;code>rss.xml&lt;/code> to catch these and replace them with the complete URL. See below for the snippet.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">{{&lt;span style="color:#ff79c6">-&lt;/span> $content &lt;span style="color:#ff79c6">:=&lt;/span> replaceRE &lt;span style="color:#f1fa8c">&amp;#34;a href=\&amp;#34;(#.*?)\&amp;#34;&amp;#34;&lt;/span> (printf &lt;span style="color:#f1fa8c">&amp;#34;%s%s%s&amp;#34;&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;a href=\&amp;#34;&amp;#34;&lt;/span> .Permalink &lt;span style="color:#f1fa8c">&amp;#34;$1\&amp;#34;&amp;#34;&lt;/span>) .Content &lt;span style="color:#ff79c6">-&lt;/span>}}
{{&lt;span style="color:#ff79c6">-&lt;/span> $content = replaceRE &lt;span style="color:#f1fa8c">&amp;#34;img src=\&amp;#34;(.*?)\&amp;#34;&amp;#34;&lt;/span> (printf &lt;span style="color:#f1fa8c">&amp;#34;%s%s%s&amp;#34;&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;img src=\&amp;#34;&amp;#34;&lt;/span> .Permalink &lt;span style="color:#f1fa8c">&amp;#34;$1\&amp;#34;&amp;#34;&lt;/span>) $content &lt;span style="color:#ff79c6">-&lt;/span>}}
&amp;lt;description&amp;gt;{{ $content | html }}&amp;lt;&lt;span style="color:#ff79c6">/&lt;/span>description&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;h2 id="adding-cards-for-posts">Adding cards for posts&lt;/h2>
&lt;p>Not dissimilar to &lt;a href="https://barkersocial.com/social-cards/">social media cards&lt;/a>, you can also have cards appear for your RSS posts in order to make them more attractive for readers to click on!&lt;/p>
&lt;figure class="center">&lt;a href="inoreader-enclosure-card-view.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/inoreader-enclosure-card-view.png"
alt="inoreader displaying images for each post when in card view"/> &lt;/a>&lt;figcaption>
&lt;p>While in card view for inoreader, we can see featured images being displayed&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>You can do these in RSS via the &lt;a href="https://www.w3schools.com/xml/rss_tag_enclosure.asp">enclosure&lt;/a> tag&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#ff79c6">enclosure&lt;/span> &lt;span style="color:#50fa7b">url&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image-location.png&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">type&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image/jpg&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff79c6">enclosure&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you have a look at our &lt;code>layouts/_default/rss.xml&lt;/code> file, we don&amp;rsquo;t have this defined. We could go and add it in now, but I would like a unified social media image to be used across all platforms. This will enable me to focus my effort on generating a single social media card image that is shared across all methods of consumption.&lt;/p>
&lt;p>Based on the above, my theme (hugo-coder), renders the tags required for social media cards through the &lt;a href="https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/twitter_cards.html">internal template&lt;/a> for &lt;a href="https://gohugo.io/templates/internal/#use-the-twitter-cards-template">twitter_cards&lt;/a>. A snippet of the logic that determines this:&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{- with $.Params.images -}}
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:card&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;summary_large_image&amp;#34;&lt;/span>/&amp;gt;
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:image&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ index . 0 | absURL }}&amp;#34;&lt;/span>/&amp;gt;
{{ else -}}
{{- $images := $.Resources.ByType &amp;#34;image&amp;#34; -}}
{{- $featured := $images.GetMatch &amp;#34;*feature*&amp;#34; -}}
{{- if not $featured }}{{ $featured = $images.GetMatch &amp;#34;{*cover*,*thumbnail*}&amp;#34; }}{{ end -}}
{{- with $featured -}}
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:card&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;summary_large_image&amp;#34;&lt;/span>/&amp;gt;
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:image&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ $featured.Permalink }}&amp;#34;&lt;/span>/&amp;gt;
{{- else -}}
{{- with $.Site.Params.images -}}
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:card&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;summary_large_image&amp;#34;&lt;/span>/&amp;gt;
&amp;lt;&lt;span style="color:#ff79c6">meta&lt;/span> &lt;span style="color:#50fa7b">name&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;twitter:image&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">content&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ index . 0 | absURL }}&amp;#34;&lt;/span>/&amp;gt;
{{ else -}}
...
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The hierarchy of images used to render the social media card goes like this:&lt;/p>
&lt;ol>
&lt;li>The first entry in the list of &lt;code>images&lt;/code> found in the post front matter&lt;/li>
&lt;li>Any image in the post leaf bundle containing &lt;code>feature&lt;/code> in its name&lt;/li>
&lt;li>Any image in the post leaf bundle containing either &lt;code>cover&lt;/code> or &lt;code>thumbnail&lt;/code> in its name&lt;/li>
&lt;li>The default image defined at the site level params&lt;/li>
&lt;/ol>
&lt;h3 id="adding-enclosure-tags">Adding enclosure tags&lt;/h3>
&lt;p>We can effectively copy and paste the code being used for generating Twitter cards and modify it for enclosure tags. The snippet of code ultimately ends up looking like this ðŸ‘‡&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{- $pagePermalink := .Permalink -}}
{{- with .Params.images -}}
{{- $img := index . 0 -}}
&amp;lt;&lt;span style="color:#ff79c6">enclosure&lt;/span> &lt;span style="color:#50fa7b">url&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ printf &amp;#34;&lt;/span>%&lt;span style="color:#50fa7b">s&lt;/span>%&lt;span style="color:#50fa7b">s&lt;/span>&amp;#34; $&lt;span style="color:#50fa7b">pagePermalink&lt;/span> $&lt;span style="color:#50fa7b">img&lt;/span> }}&amp;#34; &lt;span style="color:#50fa7b">type&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image/jpg&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff79c6">enclosure&lt;/span>&amp;gt;
{{ else -}}
{{- $images := .Resources.ByType &amp;#34;image&amp;#34; -}}
{{- $featured := $images.GetMatch &amp;#34;*feature*&amp;#34; -}}
{{- if not $featured }}{{ $featured = $images.GetMatch &amp;#34;{*cover*,*thumbnail*}&amp;#34; }}{{ end -}}
{{- with $featured -}}
&amp;lt;&lt;span style="color:#ff79c6">enclosure&lt;/span> &lt;span style="color:#50fa7b">url&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ $featured.Permalink }}&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">type&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image/jpg&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff79c6">enclosure&lt;/span>&amp;gt;
{{- else -}}
{{- with .Site.Params.images -}}
&amp;lt;&lt;span style="color:#ff79c6">enclosure&lt;/span> &lt;span style="color:#50fa7b">url&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ index . 0 | absURL }}&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">type&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;image/jpg&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#ff79c6">enclosure&lt;/span>&amp;gt;
{{- end -}}
{{- end -}}
{{- end }}
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Walking through what this is doing:&lt;/p>
&lt;ul>
&lt;li>Lines 1-4 will use the image defined in the &lt;code>images&lt;/code> in the post front matter, if it exists
&lt;ul>
&lt;li>I had to define &lt;code>{{-/* $pagePermalink := .Permalink */-}}&lt;/code> on line 1 to make &lt;code>.Permalink&lt;/code> available inside the &lt;code>with&lt;/code> block at line 4&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Line 7 will find an image containing &lt;code>feature&lt;/code> in its name, at the post leaf bundle section, if an image is not found previously&lt;/li>
&lt;li>Line 8 will revert to an image containing either &lt;code>cover&lt;/code> or &lt;code>thumbnail&lt;/code>, if an image is not found previously&lt;/li>
&lt;li>Lines 12-13 will default to the image defined at the site level params&lt;/li>
&lt;/ul>
&lt;p>With lessons learnt trying to get &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/#rendering-images-in-rss-posts">images to display in RSS content&lt;/a>, I am rendering the full URL of the image to ensure RSS is always able to retrieve it.&lt;/p>
&lt;p>I&amp;rsquo;m going to follow lines 12-13 above and have a default card defined at the site level parameters. In my &lt;code>config.toml&lt;/code> I&amp;rsquo;ll need to add the following&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-toml" data-lang="toml">[params]
images = [&lt;span style="color:#f1fa8c">&amp;#34;images/jdheyburn_co_uk_card.png&amp;#34;&lt;/span>]
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;while also ensuring that I&amp;rsquo;ve placed the image under &lt;code>static/images/jdheyburn_co_uk_card.png&lt;/code>.&lt;/p>
&lt;p>Once all that is done and deployed - we will have an RSS post card that looks like this ðŸ™Œ&lt;/p>
&lt;figure class="center">&lt;a href="hugo-enclosure-card-view.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/hugo-enclosure-card-view.png"
alt="inoreader displaying an image for a Hugo post"/> &lt;/a>
&lt;/figure>
&lt;p>We can now advertise our RSS subscription URL to readers. My theme &lt;code>hugo-coder&lt;/code> supports this as a social button on the home page. We just need to add the below block to the &lt;code>config.toml&lt;/code> file.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-toml" data-lang="toml">[[params.social]]
name = &lt;span style="color:#f1fa8c">&amp;#34;RSS&amp;#34;&lt;/span>
icon = &lt;span style="color:#f1fa8c">&amp;#34;fas fa-rss&amp;#34;&lt;/span>
weight = &lt;span style="color:#bd93f9">6&lt;/span>
url = &lt;span style="color:#f1fa8c">&amp;#34;https://jdheyburn.co.uk/index.xml&amp;#34;&lt;/span>
rel = &lt;span style="color:#f1fa8c">&amp;#34;alternate&amp;#34;&lt;/span>
type = &lt;span style="color:#f1fa8c">&amp;#34;application/rss+xml&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Once done - our homepage will have the button displayed.&lt;/p>
&lt;figure class="center">&lt;a href="rss-subscription-button.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-6-three-steps-to-improve-hugos-rss-feeds/rss-subscription-button.png"
alt="RSS subscription button displayed on the homepage"/> &lt;/a>
&lt;/figure>
&lt;h2 id="summarising-changes-to-rss-xml">Summarising changes to RSS XML&lt;/h2>
&lt;p>You can view the gist below to see my complete RSS XML file after all the above has been added. If you wish to use it, you&amp;rsquo;ll need to place it in &lt;code>layouts/_default/rss.xml&lt;/code> in your project directory.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920.js">&lt;/script>
&lt;p>&lt;a href="https://gist.github.com/jdheyburn/a0a2c678f8f9795088b2779ec6af9920/revisions">Click here&lt;/a> for a &lt;code>git diff&lt;/code> view on the changes I made from the default RSS XML file.&lt;/p>
&lt;p>Thanks for reading! ðŸ’¯&lt;/p></description></item><item><title>Who Goes Blogging 5: Updates Galore!</title><enclosure url="https://jdheyburn.co.uk/images/jdheyburn_co_uk_card.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/</link><pubDate>Sun, 19 Apr 2020 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/</guid>--><description>&lt;p>In this article we&amp;rsquo;re going to continue making some improvements to our Hugo website. Some of the things going to be covered are:&lt;/p>
&lt;ol>
&lt;li>Upgrading our Hugo theme&lt;/li>
&lt;li>Upgrading the Hugo version&lt;/li>
&lt;li>Adding table of contents&lt;/li>
&lt;li>Adding support for title emojis&lt;/li>
&lt;/ol>
&lt;p>So far since this website has launched we haven&amp;rsquo;t upgraded either the Hugo version used to build our website, alongside the theme being used. Hugo is a very active project with new features and bug fixes being added all the time. By not upgrading Hugo, we are missing out on enhancements that we can make to the site.&lt;/p>
&lt;p>As for upgrading the theme, improvements in the styling or even making use of said new features in Hugo can be added as part of the theme. Remember that when you execute a &lt;code>hugo&lt;/code> command, turning the website from markdown to rendered HTML files, that the theme chosen will be used to render those files.&lt;/p>
&lt;h2 id="upgrading-hugo">Upgrading Hugo&lt;/h2>
&lt;p>This varies depending on what OS you are running on, but it is pretty much identical as the steps taken to install Hugo in the &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/#blog-bootstrapping">first place&lt;/a>. Even the &lt;a href="https://gohugo.io/getting-started/installing/#upgrade-hugo">documentation for upgrading&lt;/a> is a one-liner:&lt;/p>
&lt;blockquote>
&lt;p>Upgrading Hugo is as easy as downloading and replacing the executable youâ€™ve placed in your &lt;code>PATH&lt;/code>, or running &lt;code>brew upgrade hugo&lt;/code> if using Homebrew on macOS.&lt;/p>
&lt;/blockquote>
&lt;p>A quick execute of &lt;code>hugo version&lt;/code> tells us what we&amp;rsquo;re currently running. We can then have a look at the &lt;a href="https://github.com/gohugoio/hugo/releases/">Hugo release page&lt;/a> to find the latest one - which at the time of writing is &lt;a href="https://github.com/gohugoio/hugo/releases/tag/v0.68.3">0.68.3&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ hugo version
Hugo Static Site Generator v0.58.3-4AAC02D4/extended linux/amd64 BuildDate: 2019-09-19T15:34:54Z
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I run Linux so I would need to replace the executable on my &lt;code>PATH&lt;/code>. This can be done with a handy script to pull the archive and install it for us.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8be9fd;font-style:italic">HUGO_VERSION&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;0.68.3&amp;#34;&lt;/span>
wget &lt;span style="color:#f1fa8c">&amp;#34;https://github.com/gohugoio/hugo/releases/download/v&lt;/span>&lt;span style="color:#f1fa8c">${&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">HUGO_VERSION&lt;/span>&lt;span style="color:#f1fa8c">}&lt;/span>&lt;span style="color:#f1fa8c">/hugo_extended_&lt;/span>&lt;span style="color:#f1fa8c">${&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">HUGO_VERSION&lt;/span>&lt;span style="color:#f1fa8c">}&lt;/span>&lt;span style="color:#f1fa8c">_Linux-64bit.tar.gz&amp;#34;&lt;/span>
tar -zxvf &lt;span style="color:#f1fa8c">&amp;#34;hugo_extended_&lt;/span>&lt;span style="color:#f1fa8c">${&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">HUGO_VERSION&lt;/span>&lt;span style="color:#f1fa8c">}&lt;/span>&lt;span style="color:#f1fa8c">_Linux-64bit.tar.gz&amp;#34;&lt;/span> hugo
sudo mv -v hugo /usr/local/bin
hugo version
rm &lt;span style="color:#f1fa8c">&amp;#34;hugo_extended_&lt;/span>&lt;span style="color:#f1fa8c">${&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">HUGO_VERSION&lt;/span>&lt;span style="color:#f1fa8c">}&lt;/span>&lt;span style="color:#f1fa8c">_Linux-64bit.tar.gz&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Remember that the hugo-coder theme requires the extended version of Hugo in order for it to render files correctly.&lt;/p>
&lt;blockquote>
&lt;p>You can see where &lt;code>hugo&lt;/code> is currently installed on your system with the command &lt;code>which hugo&lt;/code>, given it is in your &lt;code>PATH&lt;/code>.&lt;/p>
&lt;/blockquote>
&lt;p>Executing &lt;code>hugo version&lt;/code> one more time confirms if the upgrade took place.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ hugo version
Hugo Static Site Generator v0.68.3-157669A0/extended linux/amd64 BuildDate: 2020-03-24T12:13:38Z
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="testing-for-any-issues">Testing For Any Issues&lt;/h3>
&lt;p>At this point I would advise you do some testing with the new version to determine if your site is not only rendering as expected but functioning too. You can do this with the good old &lt;code>hugo serve&lt;/code> command as you would have used before when writing out articles, and fixing anything that looks out of place.&lt;/p>
&lt;p>However, since I&amp;rsquo;m going to be upgrading the hugo theme too, I&amp;rsquo;ll do my testing in one hit &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#validation-and-testing">later in this post&lt;/a>.&lt;/p>
&lt;h3 id="updating-hugo-in-cicd">Updating Hugo in CI/CD&lt;/h3>
&lt;p>We&amp;rsquo;ve only upgrading Hugo on our machines, but we also need to upgrade it in our CI/CD pipeline to ensure it deploys with the correct rendering too. We set this up in parts &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/">3.1&lt;/a> and &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/">3.2&lt;/a>.&lt;/p>
&lt;p>I&amp;rsquo;m using GitHub Actions for my CI/CD pipeline, so I need to head to &lt;code>.github/workflows/deploy.yml&lt;/code> and change &lt;code>hugo-version: &amp;quot;0.58.3&amp;quot;&lt;/code> to &lt;code>hugo-version: &amp;quot;0.68.3&amp;quot;&lt;/code>.&lt;/p>
&lt;p>It&amp;rsquo;s as easy as that thanks to the pre-made GitHub Action!&lt;/p>
&lt;h2 id="upgrading-hugo-theme">Upgrading Hugo Theme&lt;/h2>
&lt;h3 id="a-git-submodules-recap">A git submodules recap&lt;/h3>
&lt;p>As mentioned before, I&amp;rsquo;m using hugo-coder as the theme for my Hugo website which is being pulled as a submodule in my git repository. I can interface with it via the command &lt;code>git submodules&lt;/code>.&lt;/p>
&lt;p>One of the cool things about &lt;code>git submodules&lt;/code> is I don&amp;rsquo;t need to have a copy of the source code for the theme in my project. I can just reference the codebase at a particular point in time - or a commit, and git will pull in the resources for which then my Hugo website can utilise it.&lt;/p>
&lt;p>We already defined this back in the &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/">first post of this series&lt;/a>, in our root directory we created a file called &lt;code>.gitmodules&lt;/code> with the following contents:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#ff79c6">[&lt;/span>submodule &lt;span style="color:#f1fa8c">&amp;#34;themes/hugo-coder&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">]&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">path&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> themes/hugo-coder
&lt;span style="color:#8be9fd;font-style:italic">url&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> https://github.com/luizdepra/hugo-coder.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Line by line, we are giving the submodule a name, telling git where to check out the module to, and lastly where git can find the repository for the module when we checkout our project.&lt;/p>
&lt;p>When we pull in the submodule for the first time, it creates a tree in our projects &lt;code>.git/modules&lt;/code> filled with metadata about the submodule.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree .git/modules/themes/hugo-coder -L &lt;span style="color:#bd93f9">1&lt;/span>
.git/modules/themes/hugo-coder
â”œâ”€â”€ branches
â”œâ”€â”€ config
â”œâ”€â”€ description
â”œâ”€â”€ HEAD
â”œâ”€â”€ hooks
â”œâ”€â”€ index
â”œâ”€â”€ info
â”œâ”€â”€ logs
â”œâ”€â”€ objects
â”œâ”€â”€ packed-refs
â””â”€â”€ refs
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>The &lt;code>.git/&lt;/code> directory contains all the metadata about your repository so that &lt;code>git&lt;/code> knows where to pull/push to/from the repository, &lt;a href="https://githowto.com/git_internals_git_directory">amongst other things&lt;/a>. It has a near identical directory structure to the one shown above.&lt;/p>
&lt;/blockquote>
&lt;p>One of the files in this directory is called &lt;code>HEAD&lt;/code>, and it contains the commit of which &lt;code>git&lt;/code> should checkout the submodule&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cat .git/modules/themes/hugo-coder/HEAD
e66c1740611b15eee0069811d10b5a22b0dc4332
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can even view this commit in the repository at &lt;a href="https://github.com/luizdepra/hugo-coder/commit/e66c1740611b15eee0069811d10b5a22b0dc4332">https://github.com/luizdepra/hugo-coder/commit/e66c1740611b15eee0069811d10b5a22b0dc4332&lt;/a>.&lt;/p>
&lt;h3 id="upgrading-submodules">Upgrading Submodules&lt;/h3>
&lt;p>To upgrade submodules in your project, you simply need to execute the command below:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git submodule update --recursive --remote
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can then check the value in &lt;code>.git/modules/themes/hugo-coder/HEAD&lt;/code> and see what this is updated to.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cat .git/modules/themes/hugo-coder/HEAD
acb4bf6f2dcce51a27dc0e1f1008afb369d378d8
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Nice - this has changed from the previous value. We can jump over to GitHub to verify this is indeed the latest version.&lt;/p>
&lt;figure>&lt;a href="hugo-coder-commit.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/hugo-coder-commit.png"
alt="Screenshot showing latest hugo-coder version in GitHub"/> &lt;/a>&lt;figcaption>
&lt;p>Verify at the &lt;a href="https://github.com/luizdepra/hugo-coder/commit/master">GitHub repo page&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="validation-and-testing">Validation and Testing&lt;/h2>
&lt;p>Now comes the testing part, ensuring that everything is working as intended with both the new Hugo version and the latest hugo-coder submodule. Some of the issues I came across were:&lt;/p>
&lt;h3 id="center-tags-not-rending-correctly">&lt;code>&amp;lt;center&amp;gt;&lt;/code> tags not rending correctly&lt;/h3>
&lt;p>I believe the new Hugo version broke this one, where images that were wrapped in &lt;code>&amp;lt;center&amp;gt;&lt;/code> tags were simply disappearing. I had been wrapping &lt;code>{{&amp;lt; figure ... &amp;gt;}}&lt;/code> shortcodes in &lt;code>&amp;lt;center&amp;gt;&lt;/code> tags in order to horizontally centre images - but it looks like the new version causes these images to appear completely.&lt;/p>
&lt;p>It looks like the &lt;code>figure&lt;/code> shortcodes now support &lt;code>center&lt;/code> as a &lt;code>class&lt;/code> property. Therefore we go from&amp;hellip;&lt;/p>
&lt;p>&lt;code>&amp;lt;center&amp;gt;{{&amp;lt; figure src=&amp;quot;image-name.png&amp;quot; &amp;gt;}}&amp;lt;/center&amp;gt;&lt;/code>&lt;/p>
&lt;p>To&amp;hellip;&lt;/p>
&lt;p>&lt;code>{{&amp;lt; figure src=&amp;quot;image-name.png&amp;quot; class=&amp;quot;center&amp;quot; &amp;gt;}}&lt;/code>&lt;/p>
&lt;h3 id="lists-not-rendering-as-before">Lists not rendering as before&lt;/h3>
&lt;p>It turns out that my markdown for articles wasn&amp;rsquo;t as watertight as I thought; Hugo is now a whole lot more strict in ensuring your syntax is correct. Check these two before and after for comparison.&lt;/p>
&lt;figure>
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/old-render-list.png" class="screenshotimg"
alt="Screenshot showing old, proper list render"/>
&lt;/figure>
&lt;figure>
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/new-render-list.png" class="screenshotimg"
alt="Screenshot showing new, incorrect list render"/>
&lt;/figure>
&lt;p>For this I just needed to fix the markdown by adding another indent to the list item.&lt;/p>
&lt;figure>&lt;a href="git-diff-list.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/git-diff-list.png"
alt="Screenshot showing git diff between old and new list"/> &lt;/a>
&lt;/figure>
&lt;p>I saw several cases of this, and including a &lt;a href="https://github.com/igorshubovych/markdownlint-cli">markdown linter&lt;/a> in the CI/CD pipeline would help to prevent this. This is something I&amp;rsquo;ll look to include in the near future.&lt;/p>
&lt;h2 id="adding-new-features">Adding New Features&lt;/h2>
&lt;p>The whole reason to upgrade both Hugo and the theme was to explore some of the new features that come in both of them, so let&amp;rsquo;s get adding them.&lt;/p>
&lt;h2 id="adding-series-links-in-content-footer">Adding Series Links in Content Footer&lt;/h2>
&lt;p>The hugo-coder theme now has better support for series - these are articles that directly follow on from one another, such as this Who Goes Blogging one. Series are nothing new to Hugo and we could have done them with the version we upgraded from, only in &lt;a href="https://github.com/luizdepra/hugo-coder/commit/27e83b1e5a9d8b7bbd42d202bd5ef57adcce659b">this commit for hugo-coder&lt;/a> has it added a layout for it to be rendered.&lt;/p>
&lt;p>To create a series, we use the &lt;code>series&lt;/code> front matter setting for articles. For the Who Goes Blogging articles, adding the front matter to them looks like this.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">---
&lt;span style="color:#ff79c6">date&lt;/span>: 2020-03-10
&lt;span style="color:#ff79c6">title&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;Who Goes Blogging 3.2: Deployment Methods - GitHub Actions&amp;#34;&lt;/span>
&lt;span style="color:#6272a4">#...&lt;/span>
&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="color:#ff79c6">series&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3d3f4a"> - Who Goes Blogging
&lt;/span>&lt;span style="color:#ff79c6">tags&lt;/span>:
&lt;span style="color:#6272a4">#...&lt;/span>
---
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Once this is done for all pages, hugo-coder will render the &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#conclusion">&lt;strong>See also in &amp;hellip;&lt;/strong>&lt;/a> section at the article footer.&lt;/p>
&lt;figure>
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/series-footer-section.png" class="screenshotimg"
alt="Screenshot showing series rendered in the page footer"/>
&lt;/figure>
&lt;h2 id="adding-table-of-contents">Adding Table of Contents&lt;/h2>
&lt;p>Okay this one isn&amp;rsquo;t exactly a new feature of the theme, but since we&amp;rsquo;re playing around we may as well make use of this opportunity. Table of contents (TOC) aren&amp;rsquo;t included by default in the &lt;code>hugo-coder&lt;/code> theme, so we need to add it in ourselves.&lt;/p>
&lt;p>There is some &lt;a href="https://gohugo.io/content-management/toc/">documentation&lt;/a> on how to add TOC to your articles. Before we do that we need to revisit how layouts are organised as discussed briefly in &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/#fixing-article-rendering">a previous post&lt;/a>.&lt;/p>
&lt;h3 id="template-lookup-order-primer">Template Lookup Order Primer&lt;/h3>
&lt;p>The type of a markdown file (defined by the front matter setting &lt;code>type&lt;/code>) tells Hugo where to look for in the &lt;code>layouts/&lt;/code> directory of your project. The Hugo theme you&amp;rsquo;re using will already have these all defined, hence why they are predefined themes! Before Hugo looks for these layout HTML files in your theme, it will check for them in your projects &lt;code>layouts/&lt;/code> directory first.&lt;/p>
&lt;p>In other words, the order of precedence (or hierarchy) for HTML files is anything in the project &lt;code>layouts/&lt;/code> directory takes a higher priority than that in your theme - as described in Hugo&amp;rsquo;s &lt;a href="https://gohugo.io/templates/lookup-order/">documentation for template lookup order&lt;/a>.&lt;/p>
&lt;p>See below for a directory tree explaning this - a lot of content has been removed for brevity.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree layouts
layouts
â”œâ”€â”€ posts
â”‚ â””â”€â”€ single.html &lt;span style="color:#6272a4"># hugo will use this file to render your HTML&lt;/span>
â””â”€â”€ themes
â””â”€â”€ hugo-coder
â””â”€â”€ layouts
â””â”€â”€ posts
â””â”€â”€ single.html &lt;span style="color:#6272a4"># hugo will ignore this one in the themes directory&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="implementation">Implementation&lt;/h3>
&lt;p>The primer above gives a hint as to what file we need to modify. The &lt;a href="https://github.com/luizdepra/hugo-coder/blob/master/layouts/posts/single.html">&lt;code>single.html&lt;/code>&lt;/a> file is in charge of how articles are rendered. Since we want everything else to remain the same about this file, we can take a copy of the file as it currently stands and place it into our project root.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir layouts/posts
cp -v themes/hugo-coder/layouts/posts/single.html layouts/posts
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>I won&amp;rsquo;t go into the details here, I&amp;rsquo;ll leave that to you to make changes to see how they affect the rendering of the page.&lt;/p>
&lt;/blockquote>
&lt;p>I want the TOC to appear before the main content, but after the featured image for the article (if there is any). Based on this the files is going to need the highlighted change below.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
&lt;/span>&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#ff79c6">div&lt;/span>&amp;gt;
{{ if .Params.featured_image }}
&amp;lt;&lt;span style="color:#ff79c6">img&lt;/span> &lt;span style="color:#50fa7b">src&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;{{ .Params.featured_image }}&amp;#34;&lt;/span> &lt;span style="color:#50fa7b">alt&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;Featured image&amp;#34;&lt;/span> /&amp;gt;
{{ end }}
&lt;span style="display:block;width:100%;background-color:#3d3f4a"> {{ partial &amp;#34;toc.html&amp;#34; . }}
&lt;/span> {{ .Content }}
&amp;lt;/&lt;span style="color:#ff79c6">div&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We&amp;rsquo;re not done there - we&amp;rsquo;ve referenced a &lt;a href="https://gohugo.io/templates/partials/">partial template file&lt;/a> here. These allow us to reuse HTML files in multiple places, or to break up a large HTML file into smaller, more easier to manage chunks.&lt;/p>
&lt;p>Partial templates are found under the &lt;code>layouts/partials&lt;/code> directory and follow the same principle as defined in the primer for template lookups, and are referenced back as &lt;code>{{ partial &amp;quot;&amp;lt;partial_name&amp;gt;.html&amp;quot; . }}&lt;/code>.&lt;/p>
&lt;p>Let&amp;rsquo;s go ahead and create the &lt;code>layouts/partials/toc.html&lt;/code> file and populate it as below.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{ if and (gt .WordCount 400 ) (.Site.Params.toc) }}
&amp;lt;&lt;span style="color:#ff79c6">aside&lt;/span>&amp;gt;
{{.TableOfContents}}
&amp;lt;/&lt;span style="color:#ff79c6">aside&lt;/span>&amp;gt;
{{ end }}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This is similar to &lt;a href="https://gohugo.io/content-management/toc/#template-example-toc-partial">Hugo&amp;rsquo;s example&lt;/a> but just tweaked a bit. I&amp;rsquo;m not looking to do anything too fancy with the styling just yet, but maybe later on.&lt;/p>
&lt;p>Previewing it by &lt;code>hugo serve&lt;/code> we should get something that appears as below.&lt;/p>
&lt;figure>
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/completed-toc.png" class="screenshotimg"
alt="Screenshot showing rendered Table of Contents"/>
&lt;/figure>
&lt;h3 id="bugs-along-the-way">Bugs Along The Way&lt;/h3>
&lt;p>As the heading suggests, there were a few extra things I needed to change before releasing it into the wild.&lt;/p>
&lt;h4 id="fix-improper-headings">Fix Improper Headings&lt;/h4>
&lt;p>Per &lt;a href="https://gohugo.io/content-management/toc/#usage">Table of Contents Usage documentation&lt;/a>, Hugo will render from &lt;code>&amp;lt;h2&amp;gt;&lt;/code> headings, which are defined as &lt;code>##&lt;/code> in markdown. So &lt;code># Introduction&lt;/code> would not be included in the TOC, but &lt;code>## Introduction&lt;/code> will.&lt;/p>
&lt;p>This is a problem for some of my articles since I&amp;rsquo;ve been writing headings liberally at the wrong level.&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/improper-toc-headings.png" class="screenshotimg"
alt="Screenshot showing table of contents not including all headings for a post"/> &lt;figcaption>
&lt;p>Notice the &lt;strong>Applying Cartography&lt;/strong> heading doesn&amp;rsquo;t appear in the TOC&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The given example above shows what happens when we use &lt;code># Heading Name&lt;/code> instead of &lt;code>## Heading Name&lt;/code>. To fix this I just need to go through each heading and make sure top-level headings begin with &lt;code>##&lt;/code> and any subheadings have an additional &lt;code>#&lt;/code>.&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/proper-toc-headings.png" class="screenshotimg"
alt="Screenshot showing table of contents fixed with correct heading indentation"/> &lt;figcaption>
&lt;p>Much better!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="fix-emojis">Fix Emojis&lt;/h4>
&lt;p>Who doesn&amp;rsquo;t love the use of emojis â‰ï¸ Well I don&amp;rsquo;t when they render badly. Before this exercise I was using a custom shortcode to render them.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html"># layouts/shortcodes/emoji.html
{{ .Get 0 | emojify }}
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>&lt;a href="https://gohugo.io/content-management/shortcodes/">Shortcodes&lt;/a> are similar to partial templates in that they contain HTML, but they are usually for referring to one HTML element as opposed to multiple.&lt;/p>
&lt;/blockquote>
&lt;p>Then in my markdown I would refer back to them such as &lt;code>{{&amp;lt; emoji &amp;quot;:wave:&amp;quot; &amp;gt;}}&lt;/code>. However in headings they rendered as below&amp;hellip;&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/bad-emojis-headings.png" class="screenshotimg"
alt="Screenshot showing poorly rendered emojis in Table of Contents"/> &lt;figcaption>
&lt;p>Hugo clearly finds this hysterical&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>It&amp;rsquo;s a weird one for sure - especially since they render fine in the headings themselves already&amp;hellip;&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/good-emoji-heading-1.png" class="screenshotimg"
alt="Screenshot with heading example with emoji 1"/>
&lt;/figure>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/good-emoji-heading-2.png" class="screenshotimg"
alt="Screenshot with heading example with emoji 2"/>
&lt;/figure>
&lt;p>There is a fix for these, and it&amp;rsquo;s called &lt;em>rendering emojis the correct way!&lt;/em> ðŸ˜…&lt;/p>
&lt;p>Firstly in the site &lt;code>config.toml&lt;/code> I added &lt;code>enableEmoji = true&lt;/code> at the root level and then proceeded to change all occurrence of &lt;code>{{&amp;lt; emoji &amp;quot;:emoji_name:&amp;quot; &amp;gt;}}&lt;/code> to &lt;code>:emoji_name:&lt;/code>. With that I can then remove &lt;code>layouts/shortcodes/emoji.html&lt;/code> since it&amp;rsquo;s not being referred back to anymore.&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/correct-emoji-headings.png" class="screenshotimg"
alt="Screenshot with correct emoji rendering in table of contents"/> &lt;figcaption>
&lt;p>Nicely done&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="markdown-not-rendering">Markdown Not Rendering&lt;/h4>
&lt;p>I also noticed that markdown wasn&amp;rsquo;t rendering properly too. Given the markdown &lt;code>## Spice Up Your ~~Life~~ Python ðŸ&lt;/code>, which renders as a heading in the screenshot below&amp;hellip;&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/markdown-heading-render.png" class="screenshotimg"
alt="Screenshot showing a heading formatted correctly with markdown"/>
&lt;/figure>
&lt;p>But in the table of contents it appears without the tilde strikethrough (&lt;code>~&lt;/code>) rendering.&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/incorrect-markdown-rendering-toc.png" class="screenshotimg"
alt="Screenshot showing tilde strikethrough not appearing in table of content entry"/>
&lt;/figure>
&lt;p>This looks to be a bug within Hugo itself, since I was able to get &lt;strong>strong&lt;/strong> and &lt;em>emphasise&lt;/em> to render fine - I &lt;a href="https://github.com/gohugoio/hugo/issues/7169">raised an issue&lt;/a> on the project - I can live with it for now.&lt;/p>
&lt;h2 id="emojify-everything">Emojify Everything!&lt;/h2>
&lt;p>Continuing on the theme of emojis; we were able to get them to appear in the Table of Contents fine. But what about in the titles of the articles themselves? We can add them in the &lt;code>title&lt;/code> front matter setting like below:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">---
&lt;span style="color:#ff79c6">date&lt;/span>: 2019-07-05
&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="color:#ff79c6">title&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;:â€‹â€‹â€‹snake: Three Ways To Spice Up Your Python Code&amp;#34;&lt;/span>
&lt;/span>&lt;span style="color:#6272a4"># ...&lt;/span>
---
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Having a look around the site we see these aren&amp;rsquo;t getting rendered correctly in a number of places&amp;hellip;&lt;/p>
&lt;p>&lt;strong>(1)&lt;/strong> Post title&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/broken-emoji-post-title.png" class="screenshotimg"
alt="Screenshot of broken emoji on post title"/>
&lt;/figure>
&lt;p>&lt;strong>(2)&lt;/strong> Browser title&lt;/p>
&lt;figure class="center">&lt;a href="broken-emoji-browser-title.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/broken-emoji-browser-title.png"
alt="Screenshot of broken emoji on browser title"/> &lt;/a>
&lt;/figure>
&lt;p>&lt;strong>(3)&lt;/strong> Type list entry&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/broken-emoji-list.png" class="screenshotimg"
alt="Screenshot of broken emoji rendering on lists"/>
&lt;/figure>
&lt;p>This is all to do with how the theme is rendering these, they are not &amp;ldquo;&lt;a href="https://gohugo.io/functions/emojify/">emojifying&lt;/a>&amp;rdquo; the text it is receiving. This is easy to fix but it involves us copying over the respective files where they are being rendered from in hugo-coder and overwriting thme in our project root (back to &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#template-lookup-order-primer">template ordering&lt;/a> again!).&lt;/p>
&lt;h3 id="fix-post--browser-title">Fix Post &amp;amp; Browser Title&lt;/h3>
&lt;p>We can kill two birds with one stone since these are both found in the same file, the &lt;code>layouts/posts/single.html&lt;/code> file - this is the main file used to render the article page. If you followed &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/#implementation">above&lt;/a>, you&amp;rsquo;ll notice we already copied across that file to our project root in order to add a TOC.&lt;/p>
&lt;p>We need to go back to that file and &lt;em>emojify&lt;/em> both the main article heading, alongside the browser title to change any occurrence of &lt;code>{{ .Title }}&lt;/code> to &lt;code>{{ .Title | emojify }}&lt;/code>.&lt;/p>
&lt;p>By doing this we will &lt;em>always&lt;/em> emojify the titles even if in our &lt;code>config.toml&lt;/code> we specified &lt;code>enableEmoji = false&lt;/code>, or didn&amp;rsquo;t specify it at all. This will conflict with the default state of the setting which is &lt;code>false&lt;/code>. We could do some conditional logic on the &lt;code>enableEmoji&lt;/code> setting, but unfortunately this isn&amp;rsquo;t exposed to us to be able to perform something like &lt;code>{{ if .Site.enableEmoji }}&lt;/code>. Because of this we cannot create a pull request (PR) to merge it in with the &lt;code>hugo-coder&lt;/code> theme. I&amp;rsquo;ve raised a &lt;a href="https://github.com/gohugoio/hugo/issues/7171">couple&lt;/a> of &lt;a href="https://github.com/gohugoio/hugo/issues/7170">issues&lt;/a> against Hugo requesting these features.&lt;/p>
&lt;p>Since this is just for my website I am okay with the overriding behaviour of emojiying the title.&lt;/p>
&lt;p>See the Gist below for my completed &lt;code>single.html&lt;/code> file, including the TOC addition earlier.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/35a10e346848379ec5f6f87cb48454cd/3a30b153aae5a761f62293add95187e280d8c3d3.js">&lt;/script>
&lt;p>You&amp;rsquo;ll notice I&amp;rsquo;m emojifying (surely I&amp;rsquo;ve said this enough times to make it into the Oxford Dictionary?!) the site title too. This is incase myself (or even yourselves) wish to add emojis there too.&lt;/p>
&lt;p>The end result for the title will look like this:&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/fixed-emoji-post-title.png" class="screenshotimg"
alt="Screenshot of fixed emoji on post title"/>
&lt;/figure>
&lt;p>And the browser title is fixed accordingly:&lt;/p>
&lt;figure class="center">&lt;a href="fixed-emoji-browser-title.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/fixed-emoji-browser-title.png"
alt="Screenshot of fixed emoji on browser title"/> &lt;/a>
&lt;/figure>
&lt;h3 id="fix-type-list-entry">Fix Type List Entry&lt;/h3>
&lt;p>We need to find the file in the theme that determines how to render a list entry for a page of type &lt;code>posts&lt;/code> and make the modification there - &lt;code>layouts/posts/li.html&lt;/code>. We&amp;rsquo;ll need to do the same here as we did for &lt;code>single.html&lt;/code> and copy it to our project root.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cp -v themes/hugo-coder/layouts/posts/li.html layouts/posts
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Likewise for the title in the previous section, we need to emojify the title of the article as it&amp;rsquo;s being listed out.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/177fb9f74a38306d9257fb7302ba221c.js">&lt;/script>
&lt;p>Once done, we can see it reflect nicely in the list:&lt;/p>
&lt;figure class="center">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-5-updates-galore/fixed-emoji-list.png" class="screenshotimg"
alt="Screenshot of fixed emoji rendering on lists"/>
&lt;/figure>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>There was a lot covered in this post, to recap we&amp;hellip;&lt;/p>
&lt;ol>
&lt;li>Upgraded the Hugo version used to render the website locally, as well as in the CI/CD pipeline&lt;/li>
&lt;li>Also updated the version of the theme we&amp;rsquo;re using
&lt;ul>
&lt;li>Made use of new features that came with it such as series links&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Added a table of contents to our longer articles&lt;/li>
&lt;li>Added support for emojis in post titles&lt;/li>
&lt;/ol>
&lt;p>You can view all the changes made in this post at this &lt;a href="https://github.com/jdheyburn/jdheyburn.co.uk/pull/2">pull request&lt;/a>.&lt;/p>
&lt;p>Thanks for reading! ðŸŒ&lt;/p></description></item><item><title>Who Goes Blogging 4: Content Structure &amp; Refactoring</title><enclosure url="https://jdheyburn.co.uk/images/jdheyburn_co_uk_card.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/</link><pubDate>Tue, 31 Mar 2020 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/</guid>--><description>&lt;p>So far in this series we&amp;rsquo;ve been looking at the infrastructure behind the Hugo website, but I haven&amp;rsquo;t looked into improving the content layout of the site. Some of the improvements I want to make are:&lt;/p>
&lt;ol>
&lt;li>Moving content articles from a flat structure to a leaf bundle&lt;/li>
&lt;li>Rename content section to &lt;strong>blog&lt;/strong> from &lt;strong>posts&lt;/strong>&lt;/li>
&lt;li>Upgrading &lt;code>hugo-coder&lt;/code> theme and &lt;code>hugo&lt;/code> version&lt;/li>
&lt;li>Adding a table of contents to the pages&lt;/li>
&lt;li>&amp;hellip; and further improvements as I find them&lt;/li>
&lt;/ol>
&lt;p>This post will cover items 1-2, the others will be in a follow up post.&lt;/p>
&lt;h2 id="content-article-reorganising">Content Article Reorganising&lt;/h2>
&lt;p>Hugo has a few different ways you can organise your content, known as &lt;a href="https://gohugo.io/content-management/page-bundles/">Page Bundles&lt;/a>. Up to now I&amp;rsquo;ve adopted &lt;a href="https://gohugo.io/content-management/page-bundles/#branch-bundles">Branch Bundles&lt;/a> where I have all my articles in named markdown files under the &lt;code>content/posts&lt;/code> directory - acting as the branch bundle, and storing all images under &lt;code>static/images&lt;/code> - so the article at &lt;code>content/posts/blog-bootstrap.md&lt;/code> will be available at &lt;code>/posts/blog-bootstrap/&lt;/code>. As time has gone on, the images directory has gotten rather large and difficult to understand what images apply to what posts.&lt;/p>
&lt;p>The alternative way to organise content is the &lt;a href="https://gohugo.io/content-management/page-bundles/#leaf-bundles">Leaf Bundle&lt;/a>. This is where at a branch level you have a directory with the name of the article you wish to publish, followed by an &lt;code>index.md&lt;/code> file with the article content - such as &lt;code>content/posts/blog-bootstrap/index.md&lt;/code>.&lt;/p>
&lt;p>Any page resources defined in this directory can be referenced relatively in the markdown files within it, such that any images can be stored within &lt;code>content/posts/blog-bootstrap/&lt;/code> and referred to in the markdown as &lt;code>figure src=&amp;quot;my-relative-img.png&amp;quot; ...&lt;/code> as opposed to &lt;code>src=&amp;quot;/images/my-not-relative-img.png&amp;quot; ...&lt;/code>.&lt;/p>
&lt;p>This allows me to organise content much more effectively such that we will be going from this structure:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree content/posts
content/posts
â”œâ”€â”€ blog-bootstrap.md
â”œâ”€â”€ extending-gotests-for-strict-error-tests.md
â”œâ”€â”€ on-becoming-an-open-source-software-contributor.md
â”œâ”€â”€ three-ways-to-spice-up-your-python-code.md
â”œâ”€â”€ who-goes-blogging-0-applying-cartography.md
â”œâ”€â”€ who-goes-blogging-1-getting-started.md
â”œâ”€â”€ who-goes-blogging-2-custom-domain.md
â”œâ”€â”€ who-goes-blogging-3-1-deployment-methods-travisci.md
â””â”€â”€ who-goes-blogging-3-2-deployment-methods-github-actions.md
&lt;span style="color:#bd93f9">0&lt;/span> directories, &lt;span style="color:#bd93f9">9&lt;/span> files
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree static/images
static/images
â”œâ”€â”€ analytics_example.png
â”œâ”€â”€ ... &lt;span style="color:#6272a4"># Everything stored in a flat hierarchy&lt;/span>
â””â”€â”€ type_hinting.png
&lt;span style="color:#bd93f9">0&lt;/span> directories, &lt;span style="color:#bd93f9">57&lt;/span> files
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To this:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree content/posts
content/posts
â”œâ”€â”€ blog-bootstrap
â”‚ â””â”€â”€ index.md
â”œâ”€â”€ extending-gotests-for-strict-error-tests
â”‚ â””â”€â”€ index.md
â”œâ”€â”€ on-becoming-an-open-source-software-contributor
â”‚ â”œâ”€â”€ card.png
â”‚ â”œâ”€â”€ elephant-cartoon.png
â”‚ â””â”€â”€ index.md
â”œâ”€â”€ ...
â””â”€â”€ who-goes-blogging-3-2-deployment-methods-github-actions
â”œâ”€â”€ gha-deploy-key.png
â”œâ”€â”€ gha-secrets-key.png
â”œâ”€â”€ github-actions-build.png
â”œâ”€â”€ index.md
â””â”€â”€ travis-disable-build.png
&lt;span style="color:#bd93f9">9&lt;/span> directories, &lt;span style="color:#bd93f9">45&lt;/span> files
&lt;/code>&lt;/pre>&lt;/div>&lt;p>One other benefit of grouping all content together in a bundle is it allows you to use just one command to add your article content to the repository - no more will images in another directory be forgotten about!&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git add content/blog/&lt;span style="color:#8be9fd;font-style:italic">$articleName&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="transformation-script">Transformation Script&lt;/h3>
&lt;p>As opposed to doing the transformation manually, I&amp;rsquo;ve written a script which will move and alter the files for us.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
&lt;/span>&lt;span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#6272a4"># in project root dir&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">posts&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#ff79c6">$(&lt;/span>find content/posts -type f -name &lt;span style="color:#f1fa8c">&amp;#39;*.md&amp;#39;&lt;/span> -not -path &lt;span style="color:#f1fa8c">&amp;#39;**/index.md&amp;#39;&lt;/span> -not -path &lt;span style="color:#f1fa8c">&amp;#39;**/_index.md&amp;#39;&lt;/span>&lt;span style="color:#ff79c6">)&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">echo&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$posts&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span> | &lt;span style="color:#ff79c6">while&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">read&lt;/span> p; &lt;span style="color:#ff79c6">do&lt;/span>
&lt;span style="color:#6272a4"># Move to leaf bundle&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">postFname&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#ff79c6">$(&lt;/span>basename -- &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$p&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">)&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">title&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#f1fa8c">${&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">postFname&lt;/span>%.*&lt;span style="color:#f1fa8c">}&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">leafBundleDir&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>content/posts/&lt;span style="color:#8be9fd;font-style:italic">$title&lt;/span>
mkdir &lt;span style="color:#8be9fd;font-style:italic">$leafBundleDir&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">newPostLocation&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$leafBundleDir&lt;/span>/index.md
git mv -v &lt;span style="color:#8be9fd;font-style:italic">$p&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span>
&lt;span style="color:#6272a4"># Move images referenced in the articles to new leaf bundle dir&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">images&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#ff79c6">$(&lt;/span>grep -oP &lt;span style="color:#f1fa8c">&amp;#39;images\/.*.(png|jpg|jpeg)&amp;#39;&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span> | xargs -n1 | sort -u&lt;span style="color:#ff79c6">)&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">echo&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$images&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span> | &lt;span style="color:#ff79c6">while&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">read&lt;/span> i; &lt;span style="color:#ff79c6">do&lt;/span>
&lt;span style="color:#ff79c6">[&lt;/span> -z &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$i&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span> &lt;span style="color:#ff79c6">]&lt;/span> &lt;span style="color:#ff79c6">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ff79c6">continue&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">imgFname&lt;/span>&lt;span style="color:#ff79c6">=&lt;/span>&lt;span style="color:#ff79c6">$(&lt;/span>basename -- &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#8be9fd;font-style:italic">$i&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">)&lt;/span>
git mv -v static/&lt;span style="color:#8be9fd;font-style:italic">$i&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$leafBundleDir&lt;/span>/&lt;span style="color:#8be9fd;font-style:italic">$imgFname&lt;/span>
&lt;span style="color:#ff79c6">done&lt;/span>
&lt;span style="color:#6272a4"># Change references to images in the article&lt;/span>
&lt;span style="color:#6272a4">## figure src=&amp;#34;/images/namecheap-domain-purchase.png&amp;#34;&lt;/span>
sed -i &lt;span style="color:#f1fa8c">&amp;#39;s/src=&amp;#34;\/images\//src=&amp;#34;/g&amp;#39;&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span>
&lt;span style="color:#6272a4">## images:&lt;/span>
&lt;span style="color:#6272a4">## - images/namecheap_landing.png&lt;/span>
sed -i &lt;span style="color:#f1fa8c">&amp;#39;s/- images\//- /g&amp;#39;&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span>
&lt;span style="color:#6272a4">## [blog_arch]: /images/blog-arch-cover.png&lt;/span>
sed -i &lt;span style="color:#f1fa8c">&amp;#39;s/: \/images\//: /g&amp;#39;&lt;/span> &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span>
git add &lt;span style="color:#8be9fd;font-style:italic">$newPostLocation&lt;/span>
&lt;span style="color:#ff79c6">done&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Breaking down the script, firstly we are retrieving all posts that aren&amp;rsquo;t already converted to a leaf bundle and looping over them, where lines 4-9 performs the conversion itself.&lt;/p>
&lt;p>Once that is done then we need to get all images that are referenced in that post and move them to the new leaf bundle for the post. This is done in lines 12-17.&lt;/p>
&lt;p>Lastly, we then need to change the post content itself so that it references images in the location relative to the leaf bundle instead of under &lt;code>static/images&lt;/code> - lines 21-26 accomplish this.&lt;/p>
&lt;p>Hugo allows you to define &lt;code>img&lt;/code> blocks in several ways, where I&amp;rsquo;m currently using 3 of these methods. I &lt;del>probably&lt;/del> should replace these with one approach - for the time being 3 &lt;code>sed&lt;/code> commands will do the trick for me.&lt;/p>
&lt;blockquote>
&lt;p>I&amp;rsquo;m sure that a few lines could be cut out with some better regex expressions - but I&amp;rsquo;m not an expert at them so I&amp;rsquo;d rather crack on with what I know ðŸ˜ƒ&lt;/p>
&lt;/blockquote>
&lt;h2 id="renaming-content-section">Renaming Content Section&lt;/h2>
&lt;p>A gripe I&amp;rsquo;ve had with my site is when you click on &lt;strong>Blog&lt;/strong> in the site header it takes you to &lt;strong>Posts&lt;/strong>. Similar to the previous section this is because of &lt;a href="https://gohugo.io/content-management/page-bundles/#branch-bundles">Branch Bundles&lt;/a> which are any directory that sits underneath the &lt;code>content&lt;/code> directory. The bundle name here is what forms the URL and the parent page for those articles &lt;a href="https://gohugo.io/content-management/sections/">as defined&lt;/a>.&lt;/p>
&lt;p>Based on this information, migrating should be as easy as&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ git mv content/posts/ content/blog/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Despite doing this, we come across some problems&amp;hellip;&lt;/p>
&lt;ol>
&lt;li>We lose the correct rendering for the article
&lt;ul>
&lt;li>Hugo doesn&amp;rsquo;t know how to render content with type &lt;code>blog&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Existing URL links are broken
&lt;ul>
&lt;li>All hyperlinks both internal and external are referring to articles at &lt;code>/posts/&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Blog landing page is now &lt;strong>Blogs&lt;/strong>?? (see below)&lt;/li>
&lt;/ol>
&lt;figure>&lt;a href="blogs-landing-page.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/blogs-landing-page.png"
alt="Screenshot of Blog landing page with incorrect Blogs title"/> &lt;/a>
&lt;/figure>
&lt;p>Let&amp;rsquo;s walk through them one by one.&lt;/p>
&lt;h3 id="fixing-article-rendering">Fixing Article Rendering&lt;/h3>
&lt;p>We just made our existing articles leaf bundles that sat under &lt;code>content/posts&lt;/code>, but now this is renamed to &lt;code>content/blog&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree contents/blog -L &lt;span style="color:#bd93f9">1&lt;/span>
content/blog
â”œâ”€â”€ blog-bootstrap
â”œâ”€â”€ extending-gotests-for-strict-error-tests
â”œâ”€â”€ on-becoming-an-open-source-software-contributor
â”œâ”€â”€ three-ways-to-spice-up-your-python-code
â”œâ”€â”€ who-goes-blogging-0-applying-cartography
â”œâ”€â”€ who-goes-blogging-1-getting-started
â”œâ”€â”€ who-goes-blogging-2-custom-domain
â”œâ”€â”€ who-goes-blogging-3-1-deployment-methods-travisci
â””â”€â”€ who-goes-blogging-3-2-deployment-methods-github-actions
&lt;span style="color:#bd93f9">9&lt;/span> directories, &lt;span style="color:#bd93f9">0&lt;/span> files
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The section of which your article sits underneath also tells Hugo how it should render the page - known as &lt;a href="https://gohugo.io/content-management/types/#defining-a-content-type">Content Types&lt;/a>. Take the article blog-bootstrap which is under &lt;code>posts&lt;/code>; Hugo will look in the theme for &lt;code>layouts/posts&lt;/code> for &lt;code>html&lt;/code> files to render it against* - this is how the articles go from a markdown file to rendered HTML.&lt;/p>
&lt;blockquote>
&lt;p>* Hugo will &lt;a href="https://gohugo.io/templates/lookup-order/">first look&lt;/a> in your local project for any overriding files.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tree themes/hugo-coder/layouts/posts
themes/hugo-coder/layouts/posts
â”œâ”€â”€ li.html
â”œâ”€â”€ list.html
â””â”€â”€ single.html
&lt;span style="color:#bd93f9">0&lt;/span> directories, &lt;span style="color:#bd93f9">3&lt;/span> files
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When we change the section name the article sits in, Hugo will not know how to render it correctly and will resolve to the default rendering for the theme. This ends us with something like the below.&lt;/p>
&lt;figure>&lt;a href="posts-blog-rendering-error.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/posts-blog-rendering-error.png"
alt="Screenshot of comparison of correct and incorrect rendering - publish date, minutes to read, and tags are missing"/> &lt;/a>&lt;figcaption>
&lt;p>Correct rendering on the left - notice publish date, minutes to read, and tags are missing&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>One way of fixing this would be to also change the &lt;code>hugo-coder&lt;/code> theme from &lt;code>layouts/posts&lt;/code> to &lt;code>layouts/blog&lt;/code> - however a much simpler solution exists. We can use the &lt;code>type&lt;/code> front matter setting to tell Hugo what layout to use to render it.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">---
&lt;span style="color:#ff79c6">date&lt;/span>: 2020-03-10
&lt;span style="color:#ff79c6">title&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;Who Goes Blogging 3.2: Deployment Methods - GitHub Actions&amp;#34;&lt;/span>
&lt;span style="color:#ff79c6">description&lt;/span>: Migrating to GitHub Actions as our CI tool
&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="color:#ff79c6">type&lt;/span>: posts
&lt;/span>&lt;span style="color:#6272a4"># ...&lt;/span>
---&lt;/code>&lt;/pre>&lt;/div>
&lt;blockquote>
&lt;p>Hugo &lt;a href="https://gohugo.io/content-management/front-matter">front matter&lt;/a> are content parameter settings you place into the heading of the content - an example of this is right above!&lt;/p>
&lt;/blockquote>
&lt;p>Having to define this in every new article can become repetitive. We can make this easier for ourselves by using &lt;a href="https://gohugo.io/content-management/archetypes/">archetypes&lt;/a>; which are essentially templates that new content is templated from.&lt;/p>
&lt;p>In your project root directory, create the &lt;code>archetypes/blog&lt;/code> directory and in there a file called &lt;code>index.md&lt;/code>, and populate it with the below:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">---
&lt;span style="color:#ff79c6">draft&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;span style="color:#ff79c6">type&lt;/span>: posts
&lt;span style="color:#6272a4"># ... Add in other defaults as you see fit&lt;/span>
---
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can then create new content from this template like so:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ hugo new --kind blog blog/blog-post
/home/jdheyburn/projects/jdheyburn.co.uk/content/blog/blog-post created
$ tree content/blog/blog-post
content/blog/blog-post
â””â”€â”€ index.md
&lt;span style="color:#bd93f9">0&lt;/span> directories, &lt;span style="color:#bd93f9">1&lt;/span> file
$ cat content/blog/blog-post/index.md
---
draft: &lt;span style="color:#8be9fd;font-style:italic">true&lt;/span>
type: posts
&lt;span style="color:#6272a4"># ...&lt;/span>
---
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="fixing-existing-urls">Fixing Existing URLs&lt;/h3>
&lt;p>Changing the section the article is in affects the URL too; meaning articles will appear at &lt;code>https://jdheyburn.co.uk/blog/blog-bootstrap/&lt;/code> instead of &lt;code>https://jdheyburn.co.uk/posts/blog-bootstrap/&lt;/code>. Therefore existing hyperlinks pointing to these articles will break.&lt;/p>
&lt;p>Tnere is another quick fix available for us through the front matter setting &lt;code>aliases&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">---
&lt;span style="color:#ff79c6">date&lt;/span>: 2020-03-10
&lt;span style="color:#ff79c6">title&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;Who Goes Blogging 3.2: Deployment Methods - GitHub Actions&amp;#34;&lt;/span>
&lt;span style="color:#ff79c6">description&lt;/span>: Migrating to GitHub Actions as our CI tool
&lt;span style="color:#ff79c6">type&lt;/span>: posts
&lt;span style="display:block;width:100%;background-color:#3d3f4a">&lt;span style="color:#ff79c6">aliases&lt;/span>:
&lt;/span>&lt;span style="display:block;width:100%;background-color:#3d3f4a"> - /posts/who-goes-blogging-3-2-deployment-methods-github-actions/
&lt;/span>&lt;span style="color:#6272a4"># ...&lt;/span>
---&lt;/code>&lt;/pre>&lt;/div>
&lt;p>You can read more about how &lt;code>aliases&lt;/code> does its operations &lt;a href="https://gohugo.io/content-management/urls/#aliases">here&lt;/a>.&lt;/p>
&lt;h3 id="from-blogs-to-blog">From Blogs to Blog&lt;/h3>
&lt;p>Earlier on, we came across this weird bug&amp;hellip;&lt;/p>
&lt;figure>&lt;a href="blogs-landing-page.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-4-content-structure-and-refactoring/blogs-landing-page.png"
alt="Screenshot of Blog landing page with incorrect Blogs title"/> &lt;/a>
&lt;/figure>
&lt;p>This is occurring because of the translation feature of Hugo (sourced from &lt;a href="https://gohugo.io/functions/i18n/">i18n&lt;/a>) which converts singular word titles to plural on content section landing pages, since Hugo is listing them out. This made sense when our previous section name was posts, but now we&amp;rsquo;d rather it have say blog.&lt;/p>
&lt;p>Remembering that &lt;code>content/blog&lt;/code> is a &lt;a href="https://gohugo.io/content-management/page-bundles/#branch-bundles">branch bundle&lt;/a>, we can override the inferred title with a &lt;code>_index.md&lt;/code> file at that directory.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#6272a4"># content/blog/_index.md&lt;/span>
---
title: Blog
type: posts
---
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have another &lt;code>type: posts&lt;/code> setting here because similar to above, we want Hugo to render the landing page the same as we did for posts.&lt;/p>
&lt;h3 id="heading-to-blog">Heading to Blog&lt;/h3>
&lt;p>Lastly and most easily, the &lt;strong>Blog&lt;/strong> shortcut at the top-right corner of the page still directs us to &lt;code>/posts&lt;/code> - we need to change that in the top-level &lt;code>config.toml&lt;/code> to point to &lt;code>/blog&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-toml" data-lang="toml">[[languages.en.menu.main]]
name = &lt;span style="color:#f1fa8c">&amp;#34;Blog&amp;#34;&lt;/span>
weight = &lt;span style="color:#bd93f9">2&lt;/span>
url = &lt;span style="color:#f1fa8c">&amp;#34;/blog/&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Thanks for reading!&lt;/p></description></item><item><title>Who Goes Blogging 3.2: Deployment Methods - GitHub Actions</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/github-actions-build.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/</link><pubDate>Tue, 10 Mar 2020 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/</guid>--><description>&lt;h2 id="from-travisci-to-github-actions">From TravisCI to GitHub Actions&lt;/h2>
&lt;p>In the &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-3-1-deployment-methods-travisci/">previous post&lt;/a> we looked at moving to a CI/CD model by moving from the &lt;code>deploy.sh&lt;/code> script to TravisCI.&lt;/p>
&lt;p>In this post we will look at how we can migrate from TravisCI to &lt;a href="https://help.github.com/en/actions/getting-started-with-github-actions/about-github-actions">GitHub Actions&lt;/a>, GitHub&amp;rsquo;s own CI/CD tool.&lt;/p>
&lt;p>This post will also be useful if you are looking to onboard GitHub Actions as your CI/CD pipeline! ðŸš€&lt;/p>
&lt;h3 id="benefits-">Benefits âœ…&lt;/h3>
&lt;p>Let&amp;rsquo;s talk about why we want to migrate away from TravisCI in the first place.&lt;/p>
&lt;p>&lt;strong>Firstly and most importantly&lt;/strong>, there is a whole community of shared actions (a set of build instructions) which can save you a &lt;em>huge&lt;/em> amount of time when it comes to piecing together a CI pipeline. If the TravisCI config seemed a bit intimidating, then these will be a whole lot more gentler to you.&lt;/p>
&lt;p>Whereas in our Travis config we had to define the individual commands needed to set up our environment and then how to build it, there&amp;rsquo;s an &lt;a href="https://github.com/marketplace/actions/hugo-setup">action&lt;/a> for that! Want to include some markdown linting? There&amp;rsquo;s an &lt;a href="https://github.com/marketplace/actions/markdownlint-cli">action&lt;/a> for that!&lt;/p>
&lt;p>I think you folks get the picture now. There&amp;rsquo;s an &lt;a href="https://github.com/sdras/awesome-actions">awesome-actions&lt;/a> repository worth checking out for more actions.&lt;/p>
&lt;p>&lt;strong>Secondly&lt;/strong>, all your DevOps tools are in one place! I&amp;rsquo;m a big sucker for &lt;a href="https://about.gitlab.com/">GitLab&lt;/a> and while I don&amp;rsquo;t use it for my personal projects, I&amp;rsquo;ve used it in a past life and found its seamless integration with all other tools second-to-none. Not having to worry about integrating between multiple services can only increase your productivity - allowing you to focus more on the application you&amp;rsquo;re writing.&lt;/p>
&lt;p>&lt;strong>Lastly&lt;/strong>, all configuration is managed in the workflow configuration file. One enhancement in particular that we will be introducing can be achieved with an additional setting in the workflow config file; for us to achieve the same in Travis would have to be done via the GUI. I&amp;rsquo;m a big sucker for having configuration baked into code so this is a very good plus.&lt;/p>
&lt;h3 id="pricing-">Pricing â°&lt;/h3>
&lt;p>&lt;strong>However&lt;/strong> - one downsides to GitHub Actions is how many build minutes you get. Remember Travis allowed unlimited build minutes for a public repository? With Actions - you are limited to &lt;a href="https://github.com/pricing">2,000 minutes in their free plan&lt;/a>.&lt;/p>
&lt;p>If you&amp;rsquo;ve been building your project in Travis already, you&amp;rsquo;ll notice it has been building (in my case at least) in ~30 seconds. With a bit of maths we can then say we will have 4,000 builds in a month on GitHub Actions.&lt;/p>
&lt;p>Given that this isn&amp;rsquo;t a huge project with multiple contributors working on it, I think it&amp;rsquo;s safe to say we won&amp;rsquo;t ever reach this limit - unless you&amp;rsquo;re churning out blog posts left right and centre!&lt;/p>
&lt;p>Sound good? Let&amp;rsquo;s go.&lt;/p>
&lt;h2 id="creating-our-workflow">Creating Our Workflow&lt;/h2>
&lt;p>Like all great services in the world, there is &lt;a href="https://help.github.com/en/actions">great documentation&lt;/a> to go along with them. Take a look over there if you&amp;rsquo;d like the detailed version.&lt;/p>
&lt;p>What I will be focusing on is the documentation for two sets of predefined actions; &lt;a href="https://github.com/peaceiris/actions-hugo">actions-hugo&lt;/a> for building our website, and &lt;a href="https://github.com/peaceiris/actions-gh-pages">actions-gh-pages&lt;/a> for deploying it to GitHub Pages.&lt;/p>
&lt;h3 id="deployment-keys-setup">Deployment Keys Setup&lt;/h3>
&lt;p>The very first thing we need to do is set up some keys that will allow our source repository (where the workflow will reside on) to push the built project to the GitHub Pages repo.&lt;/p>
&lt;p>In your terminal, create those keys now and copy the contents of the public key to your clipboard.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ssh-keygen -t rsa -b &lt;span style="color:#bd93f9">4096&lt;/span> -C &lt;span style="color:#f1fa8c">&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">$(&lt;/span>git config user.email&lt;span style="color:#ff79c6">)&lt;/span>&lt;span style="color:#f1fa8c">&amp;#34;&lt;/span> -f ~/.ssh/gh-pages -N &lt;span style="color:#f1fa8c">&amp;#34;&amp;#34;&lt;/span>
Generating public/private rsa key pair.
Your identification has been saved in /home/jdheyburn/.ssh/gh-pages.
Your public key has been saved in /home/jdheyburn/.ssh/gh-pages.pub
&lt;span style="color:#6272a4"># ...&lt;/span>
$ pbcopy &amp;lt; ~/.ssh/gh-pages.pub
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>macOS has a handy terminal command to copy file contents to the clipboard called &lt;code>pbcopy&lt;/code>. I&amp;rsquo;ve created an alias on my Linux laptop that does the same.&lt;/p>
&lt;p>&lt;code>alias pbcopy=&amp;quot;xclip -selection clipboard&amp;quot;&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>In GitHub load up your GitHub Pages repo and navigate to &lt;code>Settings&lt;/code> and then &lt;code>Deploy keys&lt;/code>. Give it an appropriate name, and paste in the public key. Make sure you check &lt;code>Allow write access&lt;/code>.&lt;/p>
&lt;figure>&lt;a href="gha-deploy-key.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/gha-deploy-key.png"
alt="GitHub Pages repo deploy keys page"/> &lt;/a>
&lt;/figure>
&lt;p>Copy the contents of the &lt;em>private key&lt;/em> you created earlier (perhaps using your new command?! ðŸ˜) and navigate to the source code repository&amp;rsquo;s &lt;code>Settings&lt;/code> page, then &lt;code>Secrets&lt;/code>. You&amp;rsquo;ll need to give it a sensible name as this then referred to later in the workflow configuration. Paste the private key in the value field.&lt;/p>
&lt;figure>&lt;a href="gha-secrets-key.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/gha-secrets-key.png"
alt="GitHub source code repo secrets page"/> &lt;/a>&lt;figcaption>
&lt;p>No secrets here!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="workflow-configuration">Workflow Configuration&lt;/h3>
&lt;p>In the root directory of your source code repo, create a directory called &lt;code>.github/workflows&lt;/code>. In this directory is where GitHub Actions will look for jobs to do. Create a &lt;code>yml&lt;/code> file in this directory to contain your build job definition. I went ahead and named mine &lt;code>deploy.yml&lt;/code>, but you can name it whatever you like.&lt;/p>
&lt;p>I used the &lt;a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-repository-type---project">example&lt;/a> provided in the &lt;code>actions-gh-pages&lt;/code> documentation as a base for my build definition.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/b4b2cad15604de30f21ad0e1a85ee6b9.js">&lt;/script>
&lt;p>This config is much simpler to understand than the Travis one - let&amp;rsquo;s break it down once more.&lt;/p>
&lt;h4 id="build-metadata-and-environment">Build Metadata and Environment&lt;/h4>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">name&lt;/span>: Build and deploy to jdheyburn.github.io
&lt;span style="color:#ff79c6">on&lt;/span>:
&lt;span style="color:#ff79c6">push&lt;/span>:
&lt;span style="color:#ff79c6">branches&lt;/span>:
- master
&lt;span style="color:#ff79c6">schedule&lt;/span>:
- &lt;span style="color:#ff79c6">cron&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;0 10 * * *&amp;#34;&lt;/span>
&lt;span style="color:#ff79c6">jobs&lt;/span>:
&lt;span style="color:#ff79c6">deploy&lt;/span>:
&lt;span style="color:#ff79c6">runs-on&lt;/span>: ubuntu-18.04
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This is pretty box standard at this point. We&amp;rsquo;re simply giving the name to the workflow and saying to run it on every push to the &lt;code>master&lt;/code> branch.&lt;/p>
&lt;p>An enhancement that we&amp;rsquo;re adding is the &lt;code>on.schedule.cron&lt;/code> setting. This tells Actions not only to build the project on every push to the &lt;code>master&lt;/code> branch but on a timed schedule too - in my example this is at 10am everyday. We could have done the same via Travis, but that can only be &lt;a href="https://docs.travis-ci.com/user/cron-jobs/">configured via the GUI&lt;/a>.&lt;/p>
&lt;blockquote>
&lt;p>The benefit to this is the way in which Hugo generates content. Hugo will only build content pages where the date on the content is either today or in the past, and is not a draft.&lt;/p>
&lt;p>Therefore if you had written a post due to be published in the future, you can define that date and have the daily Hugo build publish it when that date has been reached - which is exactly how this blog post was published!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>jobs&lt;/code> is the field that contains the work we want to run. We&amp;rsquo;re giving the job a name of &lt;code>deploy&lt;/code> and telling it to run on &lt;code>ubuntu-18.04&lt;/code> - which is the equivalent to &lt;code>bionic&lt;/code> in Ubuntu.&lt;/p>
&lt;blockquote>
&lt;p>In order to keep our build the same as Travis&amp;rsquo;s, we could instruct the job to run on &lt;code>ubuntu-16.04&lt;/code>, nonetheless I&amp;rsquo;m pretty confident it will run on the next &lt;a href="https://wiki.ubuntu.com/Releases">LTS of Ubuntu&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;h4 id="project-checkout">Project Checkout&lt;/h4>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#6272a4"># ...&lt;/span>
&lt;span style="color:#ff79c6">steps&lt;/span>:
- &lt;span style="color:#ff79c6">uses&lt;/span>: actions/checkout@v2
- &lt;span style="color:#ff79c6">name&lt;/span>: Checkout submodules
&lt;span style="color:#ff79c6">shell&lt;/span>: bash
&lt;span style="color:#ff79c6">run&lt;/span>: |&lt;span style="color:#f1fa8c">
&lt;/span>&lt;span style="color:#f1fa8c"> auth_header=&amp;#34;$(git config --local --get http.https://github.com/.extraheader)&amp;#34;
&lt;/span>&lt;span style="color:#f1fa8c"> git submodule sync --recursive
&lt;/span>&lt;span style="color:#f1fa8c"> git -c &amp;#34;http.extraheader=$auth_header&amp;#34; -c protocol.version=2 submodule update --init --force --recursive --depth=1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we&amp;rsquo;re executing the GitHub &lt;a href="https://github.com/actions/checkout">checkout action&lt;/a> which will pull the repo to the build server. It&amp;rsquo;s worth noting that this action version I&amp;rsquo;m using here doesn&amp;rsquo;t checkout git submodules too - which is a problem for us as that&amp;rsquo;s how we&amp;rsquo;re currently pulling the theme for our Hugo site. We can workaround it with the next step in the build - &lt;code>Checkout submodules&lt;/code>.&lt;/p>
&lt;p>This functionality was available in v1 of the action, so you can use that if you&amp;rsquo;d prefer:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">steps&lt;/span>:
- &lt;span style="color:#ff79c6">uses&lt;/span>: actions/checkout@v2
&lt;span style="color:#ff79c6">with&lt;/span>:
&lt;span style="color:#ff79c6">submodules&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>It&amp;rsquo;s worth noting that we didn&amp;rsquo;t have to do this step for Travis - since it will checkout the repository with submodules already.&lt;/p>
&lt;p>This is because GitHub Actions can be used for many more things than just repository code manipulation where you may not necessarily need the repo checked out.&lt;/p>
&lt;/blockquote>
&lt;h4 id="build-and-deploy-setup">Build and Deploy Setup&lt;/h4>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">- &lt;span style="color:#ff79c6">name&lt;/span>: Setup Hugo
&lt;span style="color:#ff79c6">uses&lt;/span>: peaceiris/actions-hugo@v2
&lt;span style="color:#ff79c6">with&lt;/span>:
&lt;span style="color:#ff79c6">hugo-version&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;0.58.3&amp;#34;&lt;/span>
&lt;span style="color:#ff79c6">extended&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>As stated we&amp;rsquo;re going to be using the Action &lt;a href="https://github.com/peaceiris/actions-hugo">actions-hugo&lt;/a> to set up &lt;code>hugo&lt;/code> on our build server. It can take in a number of parameters to allow us to customise it; for us we&amp;rsquo;re only concerned with hardcoding the version of Hugo, and to use the Hugo Extended binary as required by our theme.&lt;/p>
&lt;blockquote>
&lt;p>At the time of writing 0.58.3 is not the latest version of Hugo, whereas when I wrote &lt;code>.travis.yml&lt;/code> it was. I want the GitHub Actions build to be as close as possible to the TravisCI build in order to make them as similar as possible to prevent any unexpected build errors.&lt;/p>
&lt;p>Once I&amp;rsquo;ve achieved a successful build - I&amp;rsquo;ll look to upgrade to a newer version, and then iron out any issues from there.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">- &lt;span style="color:#ff79c6">name&lt;/span>: Build
&lt;span style="color:#ff79c6">run&lt;/span>: hugo --gc --minify
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Once &lt;code>hugo&lt;/code> is set up we can then build it easily enough, as self-documented in the code.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">- &lt;span style="color:#ff79c6">name&lt;/span>: Copy CNAME
&lt;span style="color:#ff79c6">run&lt;/span>: cp CNAME ./public/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Lastly, we can&amp;rsquo;t forget to copy the &lt;code>CNAME&lt;/code> file we made in &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-2-custom-domain/#solidying-our-changes-with-a-cname-file">part 2&lt;/a>.&lt;/p>
&lt;h4 id="deployment-to-github-pages">Deployment to GitHub Pages&lt;/h4>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">- &lt;span style="color:#ff79c6">name&lt;/span>: Deploy
&lt;span style="color:#ff79c6">uses&lt;/span>: peaceiris/actions-gh-pages@v3
&lt;span style="color:#ff79c6">with&lt;/span>:
&lt;span style="color:#ff79c6">deploy_key&lt;/span>: ${{ secrets.DEPLOY_KEY }}
&lt;span style="color:#ff79c6">external_repository&lt;/span>: jdheyburn/jdheyburn.github.io
&lt;span style="color:#ff79c6">publish_branch&lt;/span>: master
&lt;span style="color:#ff79c6">publish_dir&lt;/span>: ./public
&lt;span style="color:#ff79c6">commit_message&lt;/span>: ${{ github.event.head_commit.message }}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For the deployment to GitHub Pages I&amp;rsquo;m using the action &lt;a href="https://github.com/peaceiris/actions-gh-pages">actions-gh-pages&lt;/a>. Again it only requires a bare minimum of parameters to work; an explanation of what I&amp;rsquo;m using is:&lt;/p>
&lt;ul>
&lt;li>&lt;code>deploy_key&lt;/code> is the &lt;em>private key&lt;/em> we set up &lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/#deployment-keys-setup">earlier in this post&lt;/a> in &lt;code>Settings&lt;/code> -&amp;gt; &lt;code>Secrets&lt;/code>
&lt;ul>
&lt;li>If you didn&amp;rsquo;t name yours &lt;code>DEPLOY_KEY&lt;/code> then you&amp;rsquo;ll need to change it here too.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>external_repository&lt;/code> tells the action where we want the built website to go to - we set this to our GitHub Pages repo&lt;/li>
&lt;li>&lt;code>publish_branch&lt;/code> is the branch of the repo we publish to&lt;/li>
&lt;li>&lt;code>publish_dir&lt;/code> is the directory on the build server that we want to push to the repo
&lt;ul>
&lt;li>Remember that &lt;code>hugo&lt;/code> builds the website to the &lt;code>public&lt;/code> directory locally&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>commit_message&lt;/code> allows us to specify a custom commit message to the target repo
&lt;ul>
&lt;li>Here I am telling it to inherit the commit message used in the source repo&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="bringing-it-all-together-again">Bringing It All Together (Again)&lt;/h2>
&lt;p>If you&amp;rsquo;re migrating from a previous CI tool (perhaps Travis?) then you&amp;rsquo;ll need to disable the builds on there since you may cause a conflict either build process.&lt;/p>
&lt;p>For Travis, you can do that by navigating to your source code repo settings on Travis (&lt;a href="https://travis-ci.com/jdheyburn/jdheyburn.co.uk/settings">https://travis-ci.com/jdheyburn/jdheyburn.co.uk/settings&lt;/a> for me) and disabling &lt;code>Build pushed branches&lt;/code>.&lt;/p>
&lt;figure class="center">&lt;a href="travis-disable-build.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/travis-disable-build.png"
alt="Build pushed branches disabled on Travis"/> &lt;/a>
&lt;/figure>
&lt;p>Now that&amp;rsquo;s done, go ahead and check in your new GitHub Actions workflow file and then navigate to the &lt;code>Actions&lt;/code> tab of your source code repo on GitHub.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git add --all
git commit -m &lt;span style="color:#f1fa8c">&amp;#39;Migrate to GitHub Actions&amp;#39;&lt;/span>
git push
&lt;/code>&lt;/pre>&lt;/div>&lt;figure>&lt;a href="github-actions-build.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-2-deployment-methods-github-actions/github-actions-build.png"
alt="Successful build on GitHub Actions"/> &lt;/a>&lt;figcaption>
&lt;p>Great success!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Hopefully your build went to success! If it didn&amp;rsquo;t have a look through the logs and see what the issue was. It took me a few builds to determine my finalised workflow config. You can even see it at my &lt;a href="https://github.com/jdheyburn/jdheyburn.co.uk/actions">source code repo Actions page&lt;/a>.&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>Now that we&amp;rsquo;ve migrated across over to GitHub Actions, we can close out the permissions that TravisCI has on our projects, and demise any secret keys we gave it.&lt;/p>
&lt;p>From the tone of my writing you can probably tell which one I favour. That&amp;rsquo;s not to say I do not like TravisCI - each service has its own pros and cons. For this particular project, I prefer the one platform approach for which I am used to in GitLab. The number of build minutes available for GA is a concern, but not one I will have to worry about for now.&lt;/p>
&lt;p>Thanks for reading! ðŸŒ&lt;/p></description></item><item><title>Who Goes Blogging 3.1: Deployment Methods - TravisCI</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travisci-card.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/</link><pubDate>Tue, 25 Feb 2020 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/</guid>--><description>&lt;h2 id="recap">Recap&lt;/h2>
&lt;p>Since &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-1-getting-started/">part 1&lt;/a>, we have been using a simple bash script called &lt;code>deploy.sh&lt;/code> to build our Hugo website and upload it to our GitHub Pages repo. In &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-2-custom-domain/">part 2&lt;/a> we modified it slightly to include the &lt;code>CNAME&lt;/code> file post-build to ensure GitHub Pages uses the custom domain we set up in that same part.&lt;/p>
&lt;p>For this part, I will tell you about how I migrated from deploying via a script, to a CI/CD tool - namely &lt;a href="https://travis-ci.com/">TravisCI&lt;/a>. Then I will document how I migrated from this, to the new &lt;a href="https://github.com/features/actions">GitHub Actions&lt;/a>; GitHub&amp;rsquo;s offering into the CI/CD space.&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>CI/CD&lt;/code> is an acronym for Continuous Integration / Continuous Deployment which is a very important concept in the DevOps culture.
If you would like to find out more about that and DevOps culture, check out these resources ðŸ‘‡&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.atlassian.com/devops">https://www.atlassian.com/devops&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/faun/the-basics-of-continuous-integration-delivery-with-10-most-popular-tools-to-use-9514231533f0">https://medium.com/faun/the-basics-of-continuous-integration-delivery-with-10-most-popular-tools-to-use-9514231533f0&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.redhat.com/en/topics/devops/what-is-ci-cd">https://www.redhat.com/en/topics/devops/what-is-ci-cd&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.atlassian.com/devops">https://www.atlassian.com/devops&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.amazon.co.uk/dp/B07B9F83WM">https://www.amazon.co.uk/dp/B07B9F83WM&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>I had originally planned this to be one post, but it soon became far too long - and I&amp;rsquo;m a fan of taking in content in sizeable chunks.&lt;/p>
&lt;p>So this post will focus on migrating to TravisCI from the &lt;code>deploy.sh&lt;/code> script. Whereas the next post will focus on migrating to, and setting up GitHub Actions. If you&amp;rsquo;re only interested in using that as your CI tool then I&amp;rsquo;ll provide a link to that here when it is posted.&lt;/p>
&lt;h2 id="moving-away-from-deploysh">Moving Away From deploy.sh&lt;/h2>
&lt;p>There&amp;rsquo;s nothing necessarily wrong with using &lt;code>deploy.sh&lt;/code> to push our code, however we want to get all the bells and whistles that Continuous Integration can provide to us such as running a series of tests and checks automatically against every commit to our repository. Once those tests and checks pass then we can automate the deployment of our website.&lt;/p>
&lt;p>Now there are many CI tools out there with the most well known likely to be &lt;a href="https://jenkins.io/">Jenkins&lt;/a>, but there are also hosted solutions available which will take your code and perform your pipelines against them.&lt;/p>
&lt;p>One of those hosted solutions is &lt;a href="https://travis-ci.com/">TravisCI&lt;/a>, where they integrate quite nicely with GitHub repositories to attach &lt;a href="https://developer.github.com/webhooks/">webhooks&lt;/a> against them. They have several pricing options available, but for public open source projects, it is completely free!&lt;/p>
&lt;p>So it is a good idea to set your source code repository on GitHub to be public. TravisCI does include (at the time of writing) private projects in their free plan, but you are capped in some shape or form on how much the platform will do for you.&lt;/p>
&lt;figure>&lt;a href="travis-free.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-free.png"
alt="Screenshot of Travis free pricing plan"/> &lt;/a>&lt;figcaption>
&lt;p>Free is definitely a thing you love to see&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="travisci-account-setup">TravisCI Account Setup&lt;/h2>
&lt;p>The TravisCI account setup for TravisCI is very streamlined - instead of creating &lt;em>another&lt;/em> account for you to manage, it integrates in with GitHub, so this is the account you use to sign-up with. Head over to &lt;a href="https://travis-ci.com/">https://travis-ci.com/&lt;/a> and click on &lt;code>Sign in with GitHub&lt;/code>.&lt;/p>
&lt;figure>&lt;a href="travis-landing.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-landing.png"
alt="Screenshot of Travis landing page"/> &lt;/a>&lt;figcaption>
&lt;p>You can&amp;rsquo;t resist a big green button&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>GitHub will ask you if you &lt;em>really&lt;/em> want to share some of your GitHub data with Travis.&lt;/p>
&lt;figure class="center">&lt;a href="travis-github-authorise.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-github-authorise.png"
alt="Screenshot of GitHub authorising Travis"/> &lt;/a>&lt;figcaption>
&lt;p>Another green button? Why not!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Once you&amp;rsquo;ve done that, you&amp;rsquo;ll be redirected to your new Travis Dashboard which&amp;hellip; is looking rather lonely ðŸ˜¦ - let&amp;rsquo;s fix that!&lt;/p>
&lt;p>All we&amp;rsquo;ve done so far is allowed Travis to reach GitHub for creating an account for us - we now need to activate GitHub Apps integration to permit it to read and write to our repositories. The &lt;a href="https://travis-ci.com/account/repositories">https://travis-ci.com/account/repositories&lt;/a> page is what you need for that - then click on the &lt;code>Activate&lt;/code> button.&lt;/p>
&lt;figure>&lt;a href="travis-github-apps-integration.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-github-apps-integration.png"
alt="Screenshot of GitHub Apps Integration"/> &lt;/a>&lt;figcaption>
&lt;p>&amp;hellip;More green buttons?!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Now on the next screen you may or may not want the default selection of &lt;code>All repositories&lt;/code> which will give Travis read and write access to all your repos. I completely trust Travis if I were to select this, however it is a best practice to follow the &lt;a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">&lt;em>principle of least privilege&lt;/em>&lt;/a> (POLP); not just for users but for services too.&lt;/p>
&lt;p>For the scope of this effort we&amp;rsquo;re only wanting Travis to read and manipulate against two repos, &lt;code>jdheyburn.co.uk&lt;/code> and &lt;code>jdheyburn.github.io&lt;/code> - it also gives you a cleaner Travis dashboard too.&lt;/p>
&lt;figure class="center">&lt;a href="travis-github-repos-selection.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-github-repos-selection.png"
alt="Screenshot of GitHub Travis Repository Authorisation"/> &lt;/a>
&lt;/figure>
&lt;h3 id="back-to-github">Back to GitHub&lt;/h3>
&lt;p>The next step is required to permit Travis to push the built project to our GitHub Pages repo. We need to generate a secret with the permissions that Travis requires and keep it aside for the Travis config file later.&lt;/p>
&lt;p>Navigate to the &lt;a href="https://github.com/settings/tokens">GitHub Personal Access Tokens&lt;/a> page and click on &lt;code>Generate new token&lt;/code>.&lt;/p>
&lt;p>You&amp;rsquo;ll come across a page asking for the name of the token being created. It doesn&amp;rsquo;t matter what you call it, but it may be useful to link it back to what it is being used for. You&amp;rsquo;re also going to want to select the &lt;code>repo&lt;/code> checkbox as done so below.&lt;/p>
&lt;p>After this you don&amp;rsquo;t need to provide any more permissions to the token. Scroll down to the end of the page and click &lt;code>Generate token&lt;/code>.&lt;/p>
&lt;figure class="center">&lt;a href="travis-github-pat.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-github-pat.png"
alt="Screenshot of GitHub Personal Access Token Creation - repos is checked"/> &lt;/a>
&lt;/figure>
&lt;p>The token&amp;rsquo;s secret will display on the next screen. &lt;strong>Make sure you copy it&lt;/strong> and place it somewhere you can refer back to it later such as a text editor like Notepad - we&amp;rsquo;ll need it again in the next section.&lt;/p>
&lt;figure class="center">&lt;a href="travis-github-pat-created.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-3-1-deployment-methods-travisci/travis-github-pat-created.png"
alt="Screenshot of GitHub Personal Access Token Creation - token complete"/> &lt;/a>
&lt;/figure>
&lt;h2 id="travisci-configuration">TravisCI Configuration&lt;/h2>
&lt;p>Once we have our Travis account set up, we need to add in a &lt;a href="https://docs.travis-ci.com/user/tutorial/">configuration file&lt;/a> that Travis will read from to determine what steps we&amp;rsquo;d like it to perform.&lt;/p>
&lt;p>In our source code repository (&lt;code>jdheyburn.co.uk&lt;/code> in my case) we want to create a file at the root directory and call it &lt;code>.travis.yml&lt;/code>. See below for an example of how I configured mine.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/073bd6d4cb9284774e7e7feee093d86f.js">&lt;/script>
&lt;p>Let&amp;rsquo;s break it down section by section.&lt;/p>
&lt;h3 id="build-environment">Build Environment&lt;/h3>
&lt;p>These settings here all refer to the build environment that we&amp;rsquo;d like our project to build on.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">dist&lt;/span>: xenial
&lt;span style="color:#ff79c6">git&lt;/span>:
&lt;span style="color:#ff79c6">depth&lt;/span>: &lt;span style="color:#ff79c6">false&lt;/span>
&lt;span style="color:#ff79c6">env&lt;/span>:
&lt;span style="color:#ff79c6">global&lt;/span>:
- HUGO_VERSION=&amp;#34;0.58.3&amp;#34;
&lt;span style="color:#ff79c6">matrix&lt;/span>:
&lt;span style="color:#ff79c6">secure&lt;/span>: REDACTED
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>dist&lt;/code> specifies what platform Travis should build the project on. In this case &lt;code>xenial&lt;/code> refers to Ubuntu 16.04, which is a Linux distribution. There are &lt;a href="https://docs.travis-ci.com/user/reference/overview/">several others&lt;/a> to choose from and more likely than not you&amp;rsquo;ll want the platform to be Linux. However if you had a Windows application written in &lt;code>.NET&lt;/code> then you would likely want it built on a Windows Server since that is what supports it.&lt;/p>
&lt;p>&lt;code>git.depth&lt;/code> tells Travis how many commits of your project to check out. This is passed directory to the &lt;code>git&lt;/code> parameter &lt;code>--depth&lt;/code> (more info on that &lt;a href="https://git-scm.com/docs/git-clone">here&lt;/a>). For our use case we&amp;rsquo;re not interested in this option so we set it to &lt;code>false&lt;/code> to disable the flag being passed to &lt;code>git&lt;/code>.&lt;/p>
&lt;p>&lt;code>env.global&lt;/code> allows us to define what variables should be set in the environment. This is done in the form of an array of strings in the format &lt;code>key=value&lt;/code>. So given the example, &lt;code>HUGO_VERSION&lt;/code> will be set to &lt;code>0.58.3&lt;/code>. We&amp;rsquo;ll come back to this later.&lt;/p>
&lt;p>&lt;code>env.matrix&lt;/code> is the encrypted value that gets passed to the &lt;code>GITHUB_TOKEN&lt;/code> environment variable which is used to allow Travis to commit the built project to our GitHub Pages repo.&lt;/p>
&lt;ul>
&lt;li>You&amp;rsquo;re going to want to take the personal access token generated from GitHub in the earlier step and encrypt it using &lt;a href="https://docs.travis-ci.com/user/environment-variables#encrypting-environment-variables">this method&lt;/a>, then add it back to this setting&lt;/li>
&lt;/ul>
&lt;h3 id="external-dependencies">External Dependencies&lt;/h3>
&lt;p>Once the build environment is defined, we can tell Travis to pull in some additional dependencies or files required for our project. Now remember this is a &lt;code>hugo&lt;/code> project and we needed to install it on our local machines to run &lt;code>deploy.sh&lt;/code>, we need to do the same for Travis too.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">install&lt;/span>:
- wget -q https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_Linux-64bit.tar.gz
- tar xf hugo_extended_${HUGO_VERSION}_Linux-64bit.tar.gz
- mv hugo ~/bin/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Remember we defined &lt;code>HUGO_VERSION&lt;/code> earlier? This is where it is called back again. In order, the steps we&amp;rsquo;re performing are:&lt;/p>
&lt;ol>
&lt;li>Downloading the archive containing the specified &lt;code>hugo&lt;/code> version&lt;/li>
&lt;li>Extracting all contents of the archive&lt;/li>
&lt;li>Moving the &lt;code>hugo&lt;/code> binary to the &lt;code>~/bin/&lt;/code> directory
&lt;ul>
&lt;li>This directory is on the build servers &lt;code>PATH&lt;/code>, which enables us to execute the binary using just the &lt;code>hugo&lt;/code> command later&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="previous-issues">Previous Issues&lt;/h4>
&lt;p>In a previous version of &lt;code>hugo&lt;/code> I used, there was an additional dependency I needed to include. The &lt;code>hugo-coder&lt;/code> theme requires to be built with Hugo Extended since it requires Sass/SCSS support.&lt;/p>
&lt;p>For this particular Hugo Extended version, it required a library which was not included in the build server distribution in the past. On the plus side - Travis allows us to define additional build steps to ensure all required libraries are on the build server beforehand.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">before_install&lt;/span>:
&lt;span style="color:#6272a4"># This workaround is required to avoid libstdc++ errors while running &amp;#34;extended&amp;#34; hugo with SASS support.&lt;/span>
- wget -q -O libstdc++6 http://security.ubuntu.com/ubuntu/pool/main/g/gcc-5/libstdc++6_5.4.0-6ubuntu1~16.04.10_amd64.deb
- sudo dpkg --force-all -i libstdc++6
&lt;/code>&lt;/pre>&lt;/div>&lt;p>However in later versions of Hugo (including the one I am using today) this dependency is no longer required, hence why it is commented out in &lt;code>.travis.yml&lt;/code>.&lt;/p>
&lt;p>You may not need this stage in your pipeline, I know my project no longer requires it. However this may come in handy later knowing that you have the option of specifying more pipeline steps if the build distribution you&amp;rsquo;re using requires some additional dependencies.&lt;/p>
&lt;h3 id="build-script">Build Script&lt;/h3>
&lt;p>Now onto the juicy stuff - building the project. This is pretty much where the &lt;code>deploy.sh&lt;/code> starts from, since on our local machines we already had the &lt;code>hugo&lt;/code> binary installed.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">script&lt;/span>:
- hugo version
- hugo --gc --minify
- cp CNAME public/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Not a lot is going on here, but to detail what each step is doing:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Print out the version of &lt;code>hugo&lt;/code> being used&lt;/p>
&lt;ul>
&lt;li>This is helpful for debugging the build. By printing out the version used we can try to replicate the bug locally for troubleshooting.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Build the project&lt;/p>
&lt;ul>
&lt;li>We do this with two flags, &lt;code>--gc&lt;/code> and &lt;code>--minify&lt;/code>. These weren&amp;rsquo;t defined in the &lt;code>deploy.sh&lt;/code> script we used earlier so let&amp;rsquo;s cover them here.
&lt;ul>
&lt;li>&lt;code>--gc&lt;/code> tells &lt;code>hugo&lt;/code> to cleanup some unused cache files after the build
&lt;ul>
&lt;li>This helps keep a tidy environment for the build server.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>--minify&lt;/code> performs &lt;a href="https://en.wikipedia.org/wiki/Minification_(programming)">minification&lt;/a> on your website to reduce the size of the generated content, enabling it to load faster on your users' devices
&lt;ul>
&lt;li>Coupled with a CDN like in the &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-2-custom-domain/#adding-our-cdn-layer">previous part&lt;/a>, your website will load almost instantly&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Copy the &lt;code>CNAME&lt;/code> file from the project root to the generated &lt;code>public/&lt;/code> directory.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>This ensures that the custom domain name we set up in the previous part continues to be set in the generated website code that gets pushed to our GitHub Pages repo. &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-2-custom-domain/#building-into-our-deploy-script">See here&lt;/a> for a refresher.&lt;/p>
&lt;blockquote>
&lt;p>This section is effectively the &amp;lsquo;CI&amp;rsquo; part of &amp;lsquo;CI/CD&amp;rsquo;. We could stop here and just use Travis as a build server to determine whether the website is able to be built successfully. Any errors in the pipeline would have resulted in a failed build.&lt;/p>
&lt;p>The next section details the Continuous Deployment, ensuring that on the successful build of a project we deploy it to our production environment.&lt;/p>
&lt;/blockquote>
&lt;h3 id="deploy-to-github-pages">Deploy to GitHub Pages&lt;/h3>
&lt;p>Once the project has been built, we need to push it to the GitHub Pages repository. Travis has &lt;a href="https://docs.travis-ci.com/user/deployment/pages/">good documentation&lt;/a> on this. My setup follows the below:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#ff79c6">deploy&lt;/span>:
&lt;span style="color:#ff79c6">provider&lt;/span>: pages
&lt;span style="color:#ff79c6">skip-cleanup&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;span style="color:#ff79c6">github-token&lt;/span>: &lt;span style="color:#f1fa8c">&amp;#34;$GITHUB_TOKEN&amp;#34;&lt;/span>
&lt;span style="color:#ff79c6">keep-history&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;span style="color:#ff79c6">local-dir&lt;/span>: public
&lt;span style="color:#ff79c6">repo&lt;/span>: jdheyburn/jdheyburn.github.io
&lt;span style="color:#ff79c6">target-branch&lt;/span>: master
&lt;span style="color:#ff79c6">verbose&lt;/span>: &lt;span style="color:#ff79c6">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For the last time, let&amp;rsquo;s walk through what each of these is doing.&lt;/p>
&lt;ul>
&lt;li>&lt;code>provider&lt;/code> tells Travis this is a GitHub Pages deployment&lt;/li>
&lt;li>&lt;code>skip-cleanup&lt;/code> set to &lt;code>true&lt;/code>, so that Travis does not delete the build before we&amp;rsquo;ve got the chance to upload it&lt;/li>
&lt;li>&lt;code>github-token&lt;/code> is set to the environment variable &lt;code>$GITHUB_TOKEN&lt;/code> which was set for us earlier on in the build environment.
&lt;ul>
&lt;li>This is passed to the provider so that it has valid credentials to push the code to the GitHub Pages repo.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>keep-history&lt;/code> performs an incremental commit against the project
&lt;ul>
&lt;li>Setting it to &lt;code>true&lt;/code> allows us to view back the changes in the commit history such as &lt;a href="https://github.com/jdheyburn/jdheyburn.github.io/commit/419da0cc71415d0253996b823d4ccf6844db4042">this one&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>local-dir&lt;/code> specifies the directory that should be pushed to the target repo
&lt;ul>
&lt;li>We set it to &lt;code>public&lt;/code> because that is the name of the generated website directory from the previous &lt;code>script&lt;/code> step&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>repo&lt;/code> is the target repo where we should be deploying to&lt;/li>
&lt;li>&lt;code>target-branch&lt;/code> is the branch that we want &lt;code>local-dir&lt;/code> to be pushed to
&lt;ul>
&lt;li>For our setup we are using &lt;code>master&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>verbose&lt;/code> specifies how much detail Travis will log about its deploy activities&lt;/li>
&lt;/ul>
&lt;p>That concludes the configuration section. Remember to change it or add in some other functionality needed for your project and save it to &lt;code>.travis.yml&lt;/code>.&lt;/p>
&lt;h2 id="bringing-it-all-together">Bringing It All Together&lt;/h2>
&lt;p>Now you&amp;rsquo;ve completed your config file, let&amp;rsquo;s check it all in to GitHub.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">git add --all
git commit -m &lt;span style="color:#f1fa8c">&amp;#39;Adding CI&amp;#39;&lt;/span>
git push
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Travis will automatically detect that a new change has been made against your repo. And with the inclusion of &lt;code>.travis.yml&lt;/code>, it will now work against that file.&lt;/p>
&lt;p>You can view the status of your repository&amp;rsquo;s build by navigating to it from the &lt;a href="https://travis-ci.com/dashboard">dashboard&lt;/a> and clicking on it.&lt;/p>
&lt;p>If any of the commands in the &lt;code>script&lt;/code> section of the config return a &lt;a href="https://en.wikipedia.org/wiki/Exit_status#Shell_and_scripts">nonzero status code&lt;/a>, the build will fail. If this happens then have a look at a build log and investigate the issue. More likely than not someone else has encountered the problem before, so Google is your gatekeeper to solutions!&lt;/p>
&lt;p>Once you&amp;rsquo;ve got a successful build, that means your website has been deployed to the GitHub Pages repo and will be available on the web to view. In a browser you can now view your changes on the website.&lt;/p>
&lt;p>If they aren&amp;rsquo;t there then your browser is most likely caching an older version. By default, websites served by GitHub Pages have a browser cache TTL &lt;a href="https://webapps.stackexchange.com/questions/119286/caching-assets-in-website-served-from-github-pages">set to 10 minutes&lt;/a>. So you can either wait 10 minutes, or clear your browser cache!&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>You&amp;rsquo;re on the way to DevOps masterclass. As mentioned the next post will focus on migrating to GitHub Actions so if you&amp;rsquo;re happy with TravisCI then there&amp;rsquo;s no more you need to do! Go ahead and add other repositories you may have to Travis and build up multiple pipelines ðŸ™Œ&lt;/p></description></item><item><title>Who Goes Blogging 2: Custom Domain</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/namecheap_landing.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/</link><pubDate>Thu, 12 Dec 2019 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/</guid>--><description>&lt;p>In the &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-1-getting-started/">previous post&lt;/a>, we got ourselves up and running with a website generated by Hugo, deployed to GitHub, and hosted by GitHub Pages.&lt;/p>
&lt;p>Now, we&amp;rsquo;re going to add a custom domain to our website so that we hide the &lt;code>&amp;lt;username&amp;gt;.github.io&lt;/code> domain that GitHub Pages is kindly hosting for us for free.&lt;/p>
&lt;p>At the same time, we&amp;rsquo;re going to make our website blazingly fast for users by adding a caching layer with a content distribution network (CDN).&lt;/p>
&lt;p>Lastly, I&amp;rsquo;m going to throw in a bonus guide on how to redirect from multiple top-level domains (TLDs) to one (e.g. &lt;code>&amp;lt;your-domain&amp;gt;.com&lt;/code> redirects to &lt;code>&amp;lt;your-domain&amp;gt;.co.uk&lt;/code>).&lt;/p>
&lt;h2 id="pre-requisites">Pre-requisites&lt;/h2>
&lt;p>There&amp;rsquo;s not much more to add from the last post. I talk a lot about domains and domain name system (DNS), which is the address-finder of the Internet, and an entirely huge beast in its own right.&lt;/p>
&lt;p>Again - I won&amp;rsquo;t try to replicate already great guides out there on the topic. So if you&amp;rsquo;d like to find out more, see below for some helpful guides.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-dns-terminology-components-and-concepts">https://www.digitalocean.com/community/tutorials/an-introduction-to-dns-terminology-components-and-concepts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://opensource.com/article/17/4/introduction-domain-name-system-dns">https://opensource.com/article/17/4/introduction-domain-name-system-dns&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="applying-a-custom-domain-to-github-pages">Applying a Custom Domain to GitHub Pages&lt;/h2>
&lt;p>Let&amp;rsquo;s add a degree of professionalism to our site by having a custom domain apply to it. You&amp;rsquo;ll need to make sure you own a domain first before you go ahead, so have a look at a few providers and see which works best for you &lt;a href="https://www.techradar.com/uk/news/best-domain-registrars-in-2019">from a comparison list&lt;/a>. I bought mine from &lt;a href="https://www.namecheap.com/">namecheap&lt;/a> just because of the price and WhoisGuard features. There may be other providers that have the same features, so make sure to make your own comparison!&lt;/p>
&lt;blockquote>
&lt;p>In the case of &lt;code>.co.uk&lt;/code> domains, because it is a UK domain that resides in the EU (for now), the WhoIS lookup is disabled by default - which is a huge win for privacy. WhoisGuard is available for non-EU domains and I highly recommend it.&lt;/p>
&lt;/blockquote>
&lt;p>GitHub has a &lt;a href="https://help.github.com/en/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site">series of documentation&lt;/a> on applying a custom domain to GitHub Pages in much greater detail than what I am about to write out, should you wish to find out more information.&lt;/p>
&lt;h2 id="acquire-a-domain">Acquire a Domain&lt;/h2>
&lt;p>The rest of the post will depict a lot of Namecheap semantics, since that is the registrar I have access to. You can choose to follow the guide alongside a different registrar if you wish, at a high-level they will be pretty similar. For now, let&amp;rsquo;s move on ahead with Namecheap and navigate through to the &lt;a href="https://www.namecheap.com/">domain purchase page&lt;/a>.&lt;/p>
&lt;figure>&lt;a href="namecheap_landing.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/namecheap_landing.png"
alt="Screenshot depicting the namecheap domain landing page"/> &lt;/a>&lt;figcaption>
&lt;p>The hardest part is deciding on the domain name&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;a href="namecheap-domain-purchase.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/namecheap-domain-purchase.png"
alt="Screenshot depicting the namecheap domain purchase page"/> &lt;/a>
&lt;/figure>
&lt;p>Once you&amp;rsquo;ve set up an account and purchased your domain, your accounts domain landing page will look something like the below.&lt;/p>
&lt;figure>&lt;a href="namecheap-domain-acquired.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/namecheap-domain-acquired.png"
alt="Screenshot depicting the namecheap domain landing page"/> &lt;/a>&lt;figcaption>
&lt;p>Make sure you have auto-renew selected, otherwise you can kiss that domain goodbye when it expires!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>When you purchase a domain from Namecheap, by default it will be pointing to their own domain name service (DNS) nameservers, as you can see from the picture above.&lt;/p>
&lt;p>This means when we type in our new domain into a browser, it will contact Namecheap for the IP address for that record.&lt;/p>
&lt;p>Currently Namecheap is none the wiser about these records, which isn&amp;rsquo;t very exciting. Let&amp;rsquo;s move on to adding the CDN for the website.&lt;/p>
&lt;h2 id="adding-our-cdn-layer">Adding Our CDN Layer&lt;/h2>
&lt;p>As discussed in a &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-0-applying-cartography/#supercharge-your-delivery">previous post&lt;/a>, a CDN can provide us with many benefits. Go check out the page for a refresher of what those are and for why I selected Cloudflare. You can use whichever you like, however the remainder of this guide will focus on Cloudflare in particular - the concepts can still be applied at a high level to other CDNs.&lt;/p>
&lt;blockquote>
&lt;p>Like with any introduction of an architectural component, a CDN has some drawbacks, such as making your service now dependent on a third party for which you have no control over. Namely Cloudflare in particular has had some high profile outages of recent date, but has been extremely reliable in my previous experiences with them.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>You can go &lt;a href="https://blog.webnames.ca/advantages-and-disadvantages-of-a-content-delivery-network/">here&lt;/a> for a list of pros and cons of CDNs. Given this information I believe you can make your own mind up on what is best for yourself. For me, I the benefits far outweigh the downsides.&lt;/p>
&lt;/blockquote>
&lt;h3 id="cloudflare-our-domain">Cloudflare our Domain&lt;/h3>
&lt;p>Create an account with &lt;a href="https://www.cloudflare.com/">Cloudflare&lt;/a> if you haven&amp;rsquo;t done so already. Once done you&amp;rsquo;ll need to click &lt;strong>Add Site&lt;/strong> at the top of the browser dashboard. Enter your newly purchased domain from the previous section.&lt;/p>
&lt;figure>&lt;a href="cloudflare-add-domain.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare-add-domain.png"
alt="Screenshot depicting the Cloudflare add domain page"/> &lt;/a>&lt;figcaption>
&lt;p>Enter your newly purchased domain from the previous section&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Go ahead now and select the free plan, if you want to &lt;a href="https://www.cloudflare.com/en-gb/plans/">go more advanced&lt;/a> then you can do so.&lt;/p>
&lt;p>Once that&amp;rsquo;s created you&amp;rsquo;ll see Cloudflare scan the DNS records for this domain you&amp;rsquo;ve added - for now let&amp;rsquo;s navigate back to the &lt;a href="https://dash.cloudflare.com/">Cloudflare Dashboard&lt;/a> and selecting the domain. You&amp;rsquo;ll be presented with a page similar to below, minus all the activity!&lt;/p>
&lt;figure>&lt;a href="cloudflare-domain-landing.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare-domain-landing.png"
alt="Screenshot depicting the Cloudflare domain home page"/> &lt;/a>&lt;figcaption>
&lt;p>Name me a more iconic duo than numbers and graphs. I&amp;rsquo;ll wait&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="update-cloudflare-dns-records">Update Cloudflare DNS Records&lt;/h3>
&lt;p>In order for Cloudflare to provide its benefits, it acts as the DNS server for your domain. This means that it will forward requests of our website to the IP addresses where our website is being hosted. It&amp;rsquo;s place in the topology is like this:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-fallback" data-lang="fallback">1. Domain registrar ---&amp;gt; 2. DNS server and CDN provider ---&amp;gt; 3. Web server location
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Translated to our architecture:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-fallback" data-lang="fallback">1. Namecheap ---&amp;gt; 2. Cloudflare ---&amp;gt; 3. GitHub Pages
&lt;/code>&lt;/pre>&lt;/div>&lt;p>What we need to do is instruct Cloudflare where to direct clients of the website. There are several ways of doing this, whether you want your website to be available at &lt;code>www.&amp;lt;your-domain&amp;gt;.co.uk&lt;/code> (CNAME record), or &lt;code>&amp;lt;your-domain&amp;gt;.co.uk&lt;/code> (APEX (A) record). Both of which are &lt;a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site">well documented by GitHub&lt;/a> already. For the purpose of this post, I&amp;rsquo;ll guide you on my set up which is an ALIAS record.&lt;/p>
&lt;p>Back to Cloudflare, you&amp;rsquo;ll need to load up the dashboard for your domain and navigate to the DNS icon in the taskbar at the top. Clicking on &lt;strong>Add record&lt;/strong> will allow you to add the A records that point to GitHub Pages&amp;rsquo;s IP addresses. As of writing (and &lt;a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site#configuring-an-apex-domain">documented&lt;/a>) they are:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-fallback" data-lang="fallback">185.199.108.153
185.199.109.153
185.199.110.153
185.199.111.153
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s add these to the Cloudflare DNS page below.&lt;/p>
&lt;figure>&lt;a href="cloudflare-dns-record.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare-dns-record.png"
alt="Screenshot depicting adding DNS records to Cloudflare"/> &lt;/a>&lt;figcaption>
&lt;p>Add in the GitHub IP addresses one by one&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Once done - your records will look something like this:&lt;/p>
&lt;figure>&lt;a href="cloudflare-completed-records.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare-completed-records.png"
alt="Screenshot depicting completed DNS management"/> &lt;/a>
&lt;/figure>
&lt;p>You&amp;rsquo;ll notice an additional CNAME record at the bottom for &lt;code>www&lt;/code>. This will redirect any requests made to &lt;code>www.jdheyburn.co.uk&lt;/code> to &lt;code>jdheyburn.co.uk&lt;/code>. This could be something you&amp;rsquo;d want to replicate too if you wish.&lt;/p>
&lt;p>One thing to note down before we move on is to capture the Cloudflare DNS Nameservers that have been assigned to our domain. You can find these on the same DNS management page we are on, but by just scrolling down we can see these nameservers.&lt;/p>
&lt;figure>&lt;a href="cloudflare-nameservers.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare-nameservers.png"
alt="Screenshot depicting completed Cloudflare DNS nameservers"/> &lt;/a>&lt;figcaption>
&lt;p>Make a note of these nameservers for your domain&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="direct-namecheap-to-cloudflare">Direct Namecheap to Cloudflare&lt;/h3>
&lt;p>&lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-2-custom-domain/#acquire-a-domain">Earlier in this post&lt;/a>, I mentioned that a newly created Namecheap domain will default to their own DNS nameservers. We want to change this to Cloudflares DNS nameservers from which we configured our DNS records.&lt;/p>
&lt;p>Navigate to the &lt;a href="https://ap.www.namecheap.com/domains/list/">Namecheap management page&lt;/a> for your domain and enter the Cloudflare nameservers once you have selected &lt;strong>Custom DNS&lt;/strong>.&lt;/p>
&lt;figure class="center">&lt;a href="namecheap-nameservers.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/namecheap-nameservers.png"
alt="Screenshot depicting completed nameservers pointing to Cloudflare"/> &lt;/a>&lt;figcaption>
&lt;p>Add in your Cloudflare domains from previously&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Once this is done you may need to wait a while for the DNS updates to propagate throughout the world. While we&amp;rsquo;re waiting for that, there&amp;rsquo;s one final piece of the puzzle which can keep us busy.&lt;/p>
&lt;h3 id="github-pages-configuration">GitHub Pages Configuration&lt;/h3>
&lt;p>The last place to configure is GitHub Pages. Currently it is hosting at our &lt;code>.github.io&lt;/code> domain, but we need to instruct it to redirect to our custom domain. There are two methods for doing this:&lt;/p>
&lt;ol>
&lt;li>Configure the repository settings&lt;/li>
&lt;li>Use a &lt;code>CNAME&lt;/code> file in your repository&lt;/li>
&lt;/ol>
&lt;h4 id="configure-the-repository-settings">Configure the repository settings&lt;/h4>
&lt;p>This is the quicker of the two solutions, so I advise to follow this step to understand if you have everything in place correctly. Once done then you can lock-in your changes with step 2 above.&lt;/p>
&lt;p>For this step, you need to navigate to the settings pages for your &lt;code>.github.io&lt;/code> repo containing your rendered code.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-fallback" data-lang="fallback">https://github.com/&amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io/settings
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now scroll down, keep going until you hit the &lt;strong>GitHub Pages&lt;/strong> heading. Here you will see a form for entering a custom domain; do the honours and enter it in like below.&lt;/p>
&lt;figure>&lt;a href="github_pages_setup.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/github_pages_setup.png"
alt="Screenshot depicting GitHub Pages form for specifying a custom domain"/> &lt;/a>&lt;figcaption>
&lt;p>Ignore my already published domain&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Now again wait for DNS to propagate across the world. When GitHub is happy with the changes then you will see the green banner similar to the one in the screenshot above. This means everything is being served up! Why not give it a try ourselves? Head to your domain now and see if everything is working!&lt;/p>
&lt;figure>&lt;a href="jdheyburn_co_uk_custom_domain.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/jdheyburn_co_uk_custom_domain.png"
alt="Screenshot depicting completed custom domain"/> &lt;/a>&lt;figcaption>
&lt;p>You should end up with something like this!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="solidying-our-changes-with-a-cname-file">Solidying our changes with a CNAME file&lt;/h4>
&lt;p>We can use the above method to quickly try using GitHub repository settings to see if everything is working, however I&amp;rsquo;m a big fan of setting changes in code (Infrastructure-as-code anyone?). GitHub supports another method which is to use a file named &lt;code>CNAME&lt;/code> in our generated &lt;code>.github.io&lt;/code> repo that contains the domain name we wish to use.&lt;/p>
&lt;p>In my case, I would have the following&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#6272a4"># CNAME&lt;/span>
jdheyburn.co.uk
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This then tells a repo that is enabled for GitHub Pages to use the domain in this file as our custom domain, effectively producing the steps in the previous section. Neato.&lt;/p>
&lt;p>The change to implement this is fairly easy. I have to admit I picked it up from somewhere but I don&amp;rsquo;t have the source to reference it to.&lt;/p>
&lt;p>So back in your &lt;code>blog-source&lt;/code> repo, you want to execute the below, replacing the template with your domain.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8be9fd;font-style:italic">echo&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;&amp;lt;DOMAIN-NAME&amp;gt;&amp;#34;&lt;/span> &amp;gt; CNAME
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="building-into-our-deploy-script">Building into our deploy script&lt;/h4>
&lt;p>Once that is done, you will need to modify your &lt;code>deploy.sh&lt;/code> script to copy over the file into your generated Hugo site, because Hugo won&amp;rsquo;t do it for you! Don&amp;rsquo;t have the deploy script or need a refresher? Head back to the &lt;a href="https://jdheyburn.co.uk/posts/who-goes-blogging-1-getting-started/#bash-script-deploying">previous post&lt;/a>.&lt;/p>
&lt;p>You will want to copy it after Hugo has done its thing, take a look at the Gist below - line 9 is your friend.&lt;/p>
&lt;script type="application/javascript" src="https://gist.github.com/jdheyburn/e84bab9176dc1753416637324a04603d.js">&lt;/script>
&lt;p>What this is doing is taking the &lt;code>CNAME&lt;/code> file that already exists in our &lt;code>blog-source&lt;/code> repo and moving it to the generated &lt;code>public/&lt;/code> directory which Hugo created for us. It is then this &lt;code>public/&lt;/code> directory that gets committed to the GitHub Pages repo.&lt;/p>
&lt;p>Then that&amp;rsquo;s it! Take a look at my &lt;a href="https://github.com/jdheyburn/jdheyburn.github.io">finished repo&lt;/a> and you&amp;rsquo;ll see where &lt;code>CNAME&lt;/code> fits in.&lt;/p>
&lt;h2 id="bonus-tld-redirection">Bonus: TLD Redirection&lt;/h2>
&lt;p>Let me tell you a story. Your website is up and operational. You&amp;rsquo;re super proud of it, and you give yourself a round of applause ðŸ‘&lt;/p>
&lt;p>But you don&amp;rsquo;t want to be the only person looking at it, you want the whole world to! You tell your parents, your significant other, the dog off the street - they all remember the name of your website, but &lt;em>was it at &lt;code>.com&lt;/code> or &lt;code>.&amp;lt;insert snazzy TLD here&amp;gt;&lt;/code>&lt;/em>?&lt;/p>
&lt;p>Of course, you domain isn&amp;rsquo;t at &lt;code>.com&lt;/code>, that&amp;rsquo;s boring as hell! You just forked out $50 on a &lt;code>.dev&lt;/code> TLD, and no one will see it!&lt;/p>
&lt;p>Luckily there is a way&amp;hellip;&lt;/p>
&lt;p>You can buy additional domains at different TLDs and have them redirect to your &lt;em>one-domain-to-rule-them-all&lt;/em> with little to no hassle! There is the cost of purchasing the domain and renewing it year after year, but with that being ~Â£10 or so per year - I&amp;rsquo;d call that a good insurance policy to ensure people land at your website!&lt;/p>
&lt;p>In my case, I purchased &lt;code>jdheyburn.com&lt;/code> and had it redirect to &lt;code>jdheyburn.co.uk&lt;/code> - why not give it a try: &lt;a href="https://jdheyburn.com">https://jdheyburn.com&lt;/a>&lt;/p>
&lt;p>The steps are already defined in this post. For a breakdown of what they are:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/#acquire-a-domain">Purchase a domain&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/#cloudflare-our-domain">Create a new website in Cloudflare&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/#update-cloudflare-dns-records">Create a DNS A record to redirect to your correct domain&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/#direct-namecheap-to-cloudflare">Configure Namecheap to use Cloudflare&amp;rsquo;s nameservers&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Steps 1 and 2 are pretty easy to perform yourselves - so for this exercise I&amp;rsquo;ll join in at step 3.&lt;/p>
&lt;h2 id="cloudflare-domain-redirection">Cloudflare Domain Redirection&lt;/h2>
&lt;p>Assuming that you&amp;rsquo;ve completed steps 1 and 2, we&amp;rsquo;ll need to configure the redirection - but we don&amp;rsquo;t do this via inserting a DNS record like we did previously, Cloudflare has a feature that handles that for us called &lt;strong>Page Rules&lt;/strong>.&lt;/p>
&lt;p>On your Cloudflare website landing page, navigate to &lt;strong>Page Rules&lt;/strong> in the toolbar at the top and then &lt;strong>Create Page Rule&lt;/strong>.&lt;/p>
&lt;figure>&lt;a href="cloudflare_page_rules.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare_page_rules.png"
alt="Screenshot depicting how to access the Create Page Rule feature"/> &lt;/a>
&lt;/figure>
&lt;p>In the next screen we&amp;rsquo;re going to define the rule. Cloudflare have &lt;a href="https://support.cloudflare.com/hc/en-us/categories/200276257-Page-Rules">documentation on Page Rules&lt;/a>, and even more &lt;a href="https://support.cloudflare.com/hc/en-us/articles/200172286-Configuring-URL-forwarding-or-redirects-with-Cloudflare-Page-Rules">specifically on redirection&lt;/a>.&lt;/p>
&lt;p>From this screen you will want something that appears as below.&lt;/p>
&lt;figure>&lt;a href="cloudflare_new_page_rule.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare_new_page_rule.png"
alt="Screenshot depicting how to populate the Create Page Rule form"/> &lt;/a>
&lt;/figure>
&lt;p>Let&amp;rsquo;s break down what&amp;rsquo;s happening here:&lt;/p>
&lt;ol>
&lt;li>We define a pattern of &lt;code>*jdheyburn.com/*&lt;/code>, indicating that the rule is active should a URL be queried to Cloudflare&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>This pattern will match any request at this domain&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>Next comes the rule action, which is:&lt;/li>
&lt;li>Set this URL as a forwarding URL - to reply back to the client with &lt;code>301 Permanent Redirect&lt;/code> status code&lt;/li>
&lt;li>With the forwarded URL being &lt;code>https://jdheyburn.co.uk/$2&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>The &lt;code>/$2&lt;/code> at the end of the rule is crucial here. This will carry across any URL path parameters or query parameters to the redirected URL. In fact &lt;code>$2&lt;/code> refers to anything that matches the second asterisk (&lt;code>*&lt;/code>) in the rule pattern (&lt;code>*jdheyburn.com/*&lt;/code>). So &lt;code>https://jdheyburn.com/contact&lt;/code> will redirect to &lt;code>https://jdheyburn.co.uk/contact&lt;/code>.&lt;/p>
&lt;blockquote>
&lt;p>Having the forwarded URL set to the &lt;code>https://&lt;/code> scheme will ensure that your users will receive your website encrypted, safe from man-in-the-middle attacks.&lt;/p>
&lt;/blockquote>
&lt;p>Lastly, click on &lt;strong>Save and Deploy&lt;/strong> to finalise your changes; you&amp;rsquo;ll have a view such as below.&lt;/p>
&lt;figure>&lt;a href="cloudflare_completed_page_rule.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-2-custom-domain/cloudflare_completed_page_rule.png"
alt="Screenshot depicting the newly created page rule"/> &lt;/a>
&lt;/figure>
&lt;p>That&amp;rsquo;s all you need - once again you will have to wait for DNS replication to trickle down. You can repeat this over again for other domains you may have.&lt;/p>
&lt;h1 id="conclusion">Conclusion&lt;/h1>
&lt;p>That it for this part, we covered quite a lot of things:&lt;/p>
&lt;ul>
&lt;li>Purchasing a custom domain&lt;/li>
&lt;li>Applying a CDN cache layer&lt;/li>
&lt;li>HTTPS redirection&lt;/li>
&lt;li>Redirect multiple domains to one location&lt;/li>
&lt;/ul>
&lt;p>Next up I&amp;rsquo;ll document the various deployment methods I have used for the website.&lt;/p></description></item><item><title>Who Goes Blogging 1: Getting Started</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/local_example_site.jpg" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/</link><pubDate>Sat, 09 Nov 2019 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/</guid>--><description>&lt;p>I&amp;rsquo;ve done a lot of talking about how this website is currently, but let&amp;rsquo;s talk about how you can get set up with the same as I have done here. Let&amp;rsquo;s recap exactly what that is:&lt;/p>
&lt;ol>
&lt;li>A GitHub repo with the site source code&lt;/li>
&lt;li>Another GitHub project with the rendered site&lt;/li>
&lt;li>Hosted on GitHub Pages&lt;/li>
&lt;li>Fronted by a custom domain&lt;/li>
&lt;li>Globally cached by a CDN&lt;/li>
&lt;li>Redirecting multiple domains&lt;/li>
&lt;/ol>
&lt;p>We&amp;rsquo;ll cover the first three points in this post, with the remainder to come in a follow up post.&lt;/p>
&lt;h2 id="pre-requisites--assumptions">Pre-requisites &amp;amp; Assumptions&lt;/h2>
&lt;p>These series of posts is aimed at between the newcomer, to intermediate programmer. There may be some concepts which I won&amp;rsquo;t be covering to due brevity, and because there are several guides out there who have explained these concepts better than I could.&lt;/p>
&lt;p>Having said that, I assume you are comfortable with the following:&lt;/p>
&lt;ul>
&lt;li>Navigating your way through a terminal&lt;/li>
&lt;li>Happy with the basic set of &lt;code>git&lt;/code> commands&lt;/li>
&lt;li>Understand how website requests are made (though this isn&amp;rsquo;t crucial)&lt;/li>
&lt;/ul>
&lt;h2 id="hugo-static-site-builder">Hugo Static Site Builder&lt;/h2>
&lt;p>There are many website building platforms out there for your static sites. There is no one platform to rule them all, you should decide on which one works best for you. For myself, I wanted to explore further into the realm of Golang as a learning opportunity. I&amp;rsquo;ve built websites from scratch before from basic HTML, CSS, and JavaScript all the way to using frameworks such as React and Angular.&lt;/p>
&lt;p>However while using these frameworks provide you with the highest flexibility in terms of customisability, they can take a while to get something out there and hosted, when really you just want something to generate the HTML and CSS for you and allow you to focus on the content.&lt;/p>
&lt;p>That&amp;rsquo;s where static site frameworks come in. They usually have some opinionated folder structure and some nuances on how things in a website should be, but comply by these rules and the website will be generated for you! Once such example is &lt;a href="https://gohugo.io/">Hugo&lt;/a> - which is what this website is built on; it&amp;rsquo;s opensource and written in Golang, you can even check out the &lt;a href="https://github.com/gohugoio/hugo">source code&lt;/a> to see how it works!&lt;/p>
&lt;blockquote>
&lt;p>While Hugo itself is free and comes with a bunch of &lt;a href="https://themes.gohugo.io/">themes&lt;/a> you can use for free, there are fancier and more feature-rich themes available to purchase from designers which may have a cost attached to them.&lt;/p>
&lt;/blockquote>
&lt;p>Hugo isn&amp;rsquo;t the only static site framework out there, there are plenty more too each with their own pros and cons. I won&amp;rsquo;t aim to reproduce a complete list of comparisons against other platforms, other people have already made the comparisons much better than I could! But nevertheless, some that I am aware of off the top of my head are &lt;a href="https://jekyllrb.com/">Jekyll&lt;/a>, &lt;a href="https://ghost.org/">Ghost&lt;/a>, and the infamous &lt;a href="https://wordpress.com/">WordPress&lt;/a> - so investigate using your search engine of choice if you wish to know the differences.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>UPDATE 2019-11-30&lt;/strong>&lt;/p>
&lt;p>I came across &lt;a href="https://news.ycombinator.com/item?id=21616149">this thread&lt;/a> on HackerNews which ultimately lead me to these comparison websites for static site generators:&lt;/p>
&lt;p>&lt;a href="https://www.staticgen.com/">https://www.staticgen.com/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://staticsitegenerators.net/">https://staticsitegenerators.net/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>All set on Hugo? Awesome - let&amp;rsquo;s get started on some project foundations.&lt;/p>
&lt;h2 id="git-set-up">Git Set Up&lt;/h2>
&lt;p>I mentioned before I split my website into two repos:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/jdheyburn/jdheyburn.co.uk">jdheyburn.co.uk&lt;/a> holds all the source code&lt;/li>
&lt;li>&lt;a href="https://github.com/jdheyburn/jdheyburn.github.io">jdheyburn.github.io&lt;/a> holds the rendered website&lt;/li>
&lt;/ul>
&lt;p>For the first repo, it doesn&amp;rsquo;t really matter what you call it - you can call it your destined domain name, or &lt;code>blog-source&lt;/code>, or &lt;code>dogs-are-great&lt;/code>. It&amp;rsquo;s the second one which you will need to think about, where it must be &lt;code>&amp;lt;YOUR_USERNAME&amp;gt;.github.io&lt;/code> - which will ultimately be made available at &lt;code>https://&amp;lt;YOUR_USERNAME&amp;gt;.github.io&lt;/code>.&lt;/p>
&lt;p>Create two &lt;a href="https://github.com/new">empty Github repos now&lt;/a>, then clone both to your environment. If you don&amp;rsquo;t have git available in your terminal, check out &lt;a href="https://help.github.com/en/github/getting-started-with-github/set-up-git">this guide&lt;/a> to get set up.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir ~/projects
&lt;span style="color:#8be9fd;font-style:italic">cd&lt;/span> projects
git clone https://github.com/&amp;lt;USERNAME&amp;gt;/blog-source.git
git clone https://github.com/&amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now that we have the repos set up, let&amp;rsquo;s get started on building the website templates.&lt;/p>
&lt;h2 id="blog-bootstrapping">Blog Bootstrapping&lt;/h2>
&lt;p>Before you get started, you&amp;rsquo;re going to need to install Hugo - head to &lt;a href="https://gohugo.io/getting-started/installing">this page&lt;/a> for instructions on going so. Once done continue on below.&lt;/p>
&lt;p>Firstly you would need to create your Hugo template. You can do this from either executing &lt;code>hugo new &amp;lt;site|theme&amp;gt;&lt;/code> and building up from there - or do what I did which was to browse the &lt;a href="https://themes.gohugo.io/">Hugo themes&lt;/a> and &lt;code>git clone&lt;/code> the example site for the chosen theme and then make your changes around that. It may entirely depend on your learning approach which way works best for you.&lt;/p>
&lt;p>In my case, I wanted to get up and running in the smallest time possible (isn&amp;rsquo;t that the point of static site generators?), so I followed the approach above.&lt;/p>
&lt;h3 id="serves-up">Serves Up!&lt;/h3>
&lt;p>The theme this blog uses as of publication is &lt;a href="https://themes.gohugo.io/hugo-coder/">hugo-coder&lt;/a>, written by &lt;a href="https://luizdepra.dev/">Luiz de PrÃ¡&lt;/a>. You may wish to use it, or something else. It&amp;rsquo;s entirely up to you! Let&amp;rsquo;s get started by laying down the foundations and cloning the theme.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8be9fd;font-style:italic">cd&lt;/span> ~/projects
git clone https://github.com/luizdepra/hugo-coder.git
cp -r hugo-coder/exampleSite blog-source
mkdir blog-source/themes
ln -s ~/projects/hugo-coder blog-source/themes/hugo-coder
&lt;span style="color:#8be9fd;font-style:italic">cd&lt;/span> blog-source
hugo serve
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That last command will locally serve the example site, so that you can view it at &lt;code>http://localhost:1313/&lt;/code>.&lt;/p>
&lt;figure>&lt;a href="local_example_site.jpg">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-1-getting-started/local_example_site.jpg"
alt="Screenshot depicting the locally run example site"/> &lt;/a>&lt;figcaption>
&lt;p>Success!&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="experimenting">Experimenting&lt;/h3>
&lt;p>Once you have the site hosted locally, feel free to make as many changes as you like to gain an understanding of how everything plugs together.&lt;/p>
&lt;p>The &lt;code>blog-template/config.toml&lt;/code> file will contain the majority of configurations that are used to generate the site. Go ahead and even comment out some config and see what affect that has. You can even &lt;a href="https://github.com/jdheyburn/jdheyburn.co.uk/blob/master/config.toml">be nosey at my config file&lt;/a> if you&amp;rsquo;re looking for some inspiration! The &lt;code>hugo serve&lt;/code> command will watch all files in the directory for any changes you make, rebuild them, and refresh your webpage too with the changes - making for hasty development!&lt;/p>
&lt;p>The Hugo config file will be a source of many informations, and the &lt;a href="https://gohugo.io/getting-started/configuration/">documentation for it is very thorough&lt;/a>. While we&amp;rsquo;re on the subject, the rest of the Hugo documentation is great, so check the rest of it out if you haven&amp;rsquo;t done so already - particularly how the &lt;a href="https://gohugo.io/getting-started/directory-structure/">directories are structured&lt;/a>, and how &lt;a href="https://gohugo.io/content-management/">content is managed&lt;/a>.&lt;/p>
&lt;p>I advise you now go off and explore all the customisation options for your site, when you&amp;rsquo;re ready to have it deployed, continue on reading.&lt;/p>
&lt;h3 id="theme-git-submodules">Theme Git Submodules&lt;/h3>
&lt;p>When we were setting up the &lt;code>exampleSite&lt;/code> locally, we created a symlink from &lt;code>~/projects/blog-source/themes/hugo-coder&lt;/code> -&amp;gt; &lt;code>~/projects/hugo-coder&lt;/code>. This is okay for local development, however not particularly the best practice in the real world. We want to take an existing git repo (hugo-coder) and apply that to a directory in our project, but what we &lt;em>don&amp;rsquo;t&lt;/em> want to do is duplicate the code in our own repo.&lt;/p>
&lt;p>This problem is solved exactly by &lt;a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">&lt;strong>git submodules&lt;/strong>&lt;/a>, and we define it within the &lt;code>.gitmodules&lt;/code> file of our source code repo.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#6272a4"># .gitmodules&lt;/span>
&lt;span style="color:#ff79c6">[&lt;/span>submodule &lt;span style="color:#f1fa8c">&amp;#34;themes/hugo-coder&amp;#34;&lt;/span>&lt;span style="color:#ff79c6">]&lt;/span>
&lt;span style="color:#8be9fd;font-style:italic">path&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> themes/hugo-coder
&lt;span style="color:#8be9fd;font-style:italic">url&lt;/span> &lt;span style="color:#ff79c6">=&lt;/span> https://github.com/luizdepra/hugo-coder.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now when this file is checked into the repo, any future clones will also include the hugo theme as a submodule in the &lt;code>themes/hugo-coder&lt;/code> directory.&lt;/p>
&lt;p>Once you&amp;rsquo;ve done this, your source code is all set! Why not share it with the rest of the world?&lt;/p>
&lt;h2 id="releasing-into-the-wild">Releasing into the wild&lt;/h2>
&lt;p>So far we have only been playing with the &lt;code>hugo serve&lt;/code> command, which is great for local development but not for production. There is a more appropriate command for building hugo projects - aptly named &lt;code>hugo&lt;/code>; pretty simple right?&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">hugo
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This renders the HTML and CSS files from your config and markdown for the theme and places them in the &lt;code>public/&lt;/code> directory of your source code repo. In theory once you&amp;rsquo;ve executed this command you can host a webserver at that address and everything would operate as normal. Why not give it a try?&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8be9fd;font-style:italic">cd&lt;/span> public/
python -m SimpleHTTPServer &lt;span style="color:#bd93f9">8080&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can even go one step further by adding flags to the &lt;code>hugo&lt;/code> command, such as &lt;code>--minify&lt;/code> which will minimalise all the supported files into a much smaller size, resulting in faster load times for your users.&lt;/p>
&lt;p>Since we are still in our source code repo, we want to make sure that &lt;code>public/&lt;/code> directory doesn&amp;rsquo;t get included in future commits. This is because the &lt;code>blog-source&lt;/code> repo should be entirely for source code, our other repo is the one that holds the rendered code.&lt;/p>
&lt;p>For this we can utilise a &lt;code>.gitignore&lt;/code> file, instructing git to ignore any files that match the terms in the contents. Let&amp;rsquo;s get one created now and check our code into the repo.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8be9fd;font-style:italic">echo&lt;/span> &lt;span style="color:#f1fa8c">&amp;#34;public/\nresources/&amp;#34;&lt;/span> &amp;gt; .gitignore
git add .
git commit -m &lt;span style="color:#f1fa8c">&amp;#39;Initial commit&amp;#39;&lt;/span>
git push
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We&amp;rsquo;re currently committing to one repo, however we want GitHub Pages to host it for us. As mentioned earlier, GP can only host repos at the domain &lt;code>github.io&lt;/code>, so we need to get our rendered website into that repo.&lt;/p>
&lt;h3 id="bash-script-deploying">Bash Script Deploying&lt;/h3>
&lt;p>Now the original way I did this was through a simple bash script which largely followed &lt;a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/#step-by-step-instructions">this process&lt;/a> as documented by the Hugo team. Note that this is largely the process we have followed thus far, with the exception of step 6 onwards - so ensure you follow those steps.&lt;/p>
&lt;blockquote>
&lt;p>I&amp;rsquo;ve since moved over onto a CI/CD platform which I will discuss in a future post.&lt;/p>
&lt;/blockquote>
&lt;p>After following the process in the link prior, you should be able to invoke your deploy script at &lt;code>./deploy.sh&lt;/code>, which will push the built &lt;code>public/&lt;/code> directory to your &lt;code>&amp;lt;USERNAME&amp;gt;.github.io&lt;/code>. GitHub should pick up that this is a GitHub Pages repo and have your site ready for you at &lt;code>https://&amp;lt;USERNAME&amp;gt;.github.io&lt;/code>!&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>In this post, we have done the following:&lt;/p>
&lt;ol>
&lt;li>Created two GitHub repos:
&lt;ul>
&lt;li>one for storing the source code for the website&lt;/li>
&lt;li>another containing the rendered web pages&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Built Hugo locally for development using &lt;code>hugo serve&lt;/code>&lt;/li>
&lt;li>Written a script for deployment&lt;/li>
&lt;li>Deployed to GitHub Pages&lt;/li>
&lt;/ol>
&lt;p>Next up, we&amp;rsquo;ll be adding a custom domain to the site, front it with a CDN, and redirect multiple domains to it.&lt;/p></description></item><item><title>Who Goes Blogging 0: Applying Cartography</title><enclosure url="https://jdheyburn.co.uk/blog/who-goes-blogging-0-applying-cartography/blog-arch-cover.png" type="image/jpg"/><link>https://jdheyburn.co.uk/blog/who-goes-blogging-0-applying-cartography/</link><pubDate>Wed, 11 Sep 2019 00:00:00 +0000</pubDate><guid>https://jdheyburn.co.uk/blog/who-goes-blogging-0-applying-cartography/</guid>--><description>&lt;h2 id="applying-cartography">Applying Cartography&lt;/h2>
&lt;p>With my academic background focused in infrastructure, I love seeing diagrams of topologies - they&amp;rsquo;re a pretty damn useful way of understanding architecture of an application flow amongst other things. Let&amp;rsquo;s take a look at how my portfolio site is architected out.&lt;/p>
&lt;p>As I mentioned in my &lt;a href="https://jdheyburn.co.uk/posts/blog-bootstrap/">first blog post&lt;/a> - I&amp;rsquo;ve got several ideas on how I can improve on the architecture of this site. But what good is evaluating where you&amp;rsquo;ve come from if you don&amp;rsquo;t document what you currently have?&lt;/p>
&lt;p>That&amp;rsquo;s when you can make true comparisons in any system. As such the aim of this series of posts will be to explain how this website is architected, so that we may reference it in future posts. Later on, I&amp;rsquo;ll also talk about how you&amp;rsquo;re able to get yourself set up as well.&lt;/p>
&lt;h3 id="the-setup">The Setup&lt;/h3>
&lt;p>Because we all love an architecture diagram, let&amp;rsquo;s slap one in now.&lt;/p>
&lt;figure>&lt;a href="blog-arch-cover.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-0-applying-cartography/blog-arch-cover.png"
alt="An architecture diagram of my portfolio site"/> &lt;/a>
&lt;/figure>
&lt;p>Wow. That is&amp;hellip; really not much at all. Apologies if you were expecting a lot more arrows and boxes!&lt;/p>
&lt;p>In a way, I shouldn&amp;rsquo;t be sorry, because one of the core priniciples in software development is KISS (Keep It Simple Stupid!) - and this setup is just an advantage of how I decided the first implementation of my website to be:&lt;/p>
&lt;ul>
&lt;li>Easy to implement&lt;/li>
&lt;li>Easy to maintain (there is none required!)&lt;/li>
&lt;/ul>
&lt;p>I&amp;rsquo;m a firm believer that you&amp;rsquo;re best off getting a minimum viable product out there ASAP and then work to perfect it afterward. What I hope to document as time goes on are the various enhancements and changes that I intend on making to the website so that yourselves can follow along too with your own site. That goes not just for this site (how much can it really be improved?!) but for whatever projects I work on.&lt;/p>
&lt;h2 id="so-what-does-it-all-mean">So what does it all mean?&lt;/h2>
&lt;p>Back to the diagram, let&amp;rsquo;s follow it from right-to-left and start talking about what&amp;rsquo;s going on.&lt;/p>
&lt;h3 id="github-pages---somewhere-to-call-home">GitHub Pages - somewhere to call home&lt;/h3>
&lt;p>You can see that the site is hosted on GitHub Pages. Essentially this is GitHub&amp;rsquo;s platform for hosting the static resources that are checked into the public repos. This then presents the assets at a domain prefix of your choosing, suffixed by &lt;code>.github.io&lt;/code> - in my case it is at &lt;code>jdheyburn.github.io&lt;/code>. GitHub Pages only hosts your site via HTTPS so you know your pages aren&amp;rsquo;t being subject to a man-in-the-middle attack, and it takes care of your TLS certificates so you don&amp;rsquo;t need to worry about renewing them!&lt;/p>
&lt;blockquote>
&lt;p>You might be wondering why you would need to serve a static site over HTTPS when you aren&amp;rsquo;t handling anything confidential. I&amp;rsquo;ll turn you to Troy Hunt&amp;rsquo;s excellent article &lt;a href="https://www.troyhunt.com/heres-why-your-static-website-needs-https/">Here&amp;rsquo;s Why Your Static Website Needs HTTPS&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;h3 id="supercharge-your-delivery">Supercharge your delivery!&lt;/h3>
&lt;p>Now that the website is hosted at GitHub - I stuck a content delivery network (CDN) in front of GitHub for a whole load of reasons, some of which are:&lt;/p>
&lt;h4 id="fast-end-user-response-times">Fast end-user response times&lt;/h4>
&lt;p>CDNs cache your content at edge locations dotted all over the globe, where the client is then served content from the one closest geographically (let me direct you to &lt;a href="https://people.eecs.berkeley.edu/~rcs/research/interactive_latency.html">latency numbers every programmer should know&lt;/a>).&lt;/p>
&lt;h4 id="security">Security&lt;/h4>
&lt;p>The CDN acts as a proxy between the client and your servers - their requests don&amp;rsquo;t actually hit you directly.&lt;/p>
&lt;p>Not only that, a lot of CDNs provide DDoS protection to ensure excessive requests don&amp;rsquo;t bring down your servers.&lt;/p>
&lt;h4 id="analytics">Analytics&lt;/h4>
&lt;p>Because everyone loves graphs and numbers&amp;hellip; right??&amp;hellip; Alright just me then&amp;hellip;&lt;/p>
&lt;p>You&amp;rsquo;ll be able to see how many requests are being served up, where requests originate from, amongst others. Take a look at an example below.&lt;/p>
&lt;figure>&lt;a href="analytics_example.png">
&lt;img src="https://jdheyburn.co.uk/blog/who-goes-blogging-0-applying-cartography/analytics_example.png"
alt="A graph displaying total requests, and how many of them were cached"/> &lt;/a>
&lt;/figure>
&lt;h4 id="custom-domain">Custom domain&lt;/h4>
&lt;ul>
&lt;li>This means you can access your site on something other than &lt;code>&amp;lt;my_site&amp;gt;.github.io&lt;/code>, which is great for when you move off GitHub Pages to another platform, you can just tell Cloudflare to source requests from another server&lt;/li>
&lt;li>It also gives your site that extra polish and professionalism about it - wouldn&amp;rsquo;t you agree?&lt;/li>
&lt;/ul>
&lt;p>My CDN of choice is &lt;a href="https://www.cloudflare.com/">Cloudflare&lt;/a>, for no reason more than is it completely free to use and will most likely stay free until I decide I would benefit from the next &lt;a href="https://www.cloudflare.com/en-gb/plans/">pricing step&lt;/a>. Did I mention the website is pretty damn easy to use as well?&lt;/p>
&lt;p>That means that the operating cost of a site like this is exactly ZILCH (nada, et al.), which again is another great reason to get set up on a platform like this.&lt;/p>
&lt;h3 id="top-level-domain-fatigue">Top-level domain fatigue?&lt;/h3>
&lt;p>I&amp;rsquo;m from the UK - and I wanted my site to reflect that, so I purchased a domain with the top-level domain (TLD) &lt;code>.co.uk&lt;/code>. However when users come to visit me on my site they may not always remember whether it was &lt;code>.com&lt;/code>, &lt;code>.dev&lt;/code>, &lt;code>.tk&lt;/code> (remember those?). Therefore I also have &lt;code>jdheyburn.com&lt;/code> set up in the same way as its &lt;code>.co.uk&lt;/code> sibling to maximise that user experience.&lt;/p>
&lt;p>Okay well that means there is a slight cost to maintain the site through purchasing and renewing the custom domains (notice how jdheyburn.com redirects to jdheyburn.co.uk?) but we&amp;rsquo;re talking in the Â£10s per year for these two.&lt;/p>
&lt;p>So if you&amp;rsquo;re interested in having a setup like this, then over the next few posts I&amp;rsquo;ll be detailing how you can do the same.&lt;/p>
&lt;p>- jdheyburn&lt;/p></description></item></channel></rss>